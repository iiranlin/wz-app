(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bad149c"],{"004f":function(e,t,r){"use strict";var n=r("c7eb"),a=r("1da1"),i=(r("d9e2"),r("d401"),r("b705"));t["a"]={data:function(){return{}},filters:{},computed:{},methods:{getCommonDictList:function(){var e=arguments;return Object(a["a"])(Object(n["a"])().mark((function t(){var r,a,c,s,u;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"",r){t.next=3;break}return t.abrupt("return");case 3:return a=[],t.prev=4,t.next=7,Object(i["a"])(r);case 7:c=t.sent,s=c.data,u=void 0===s?[]:s,a=u,t.next=16;break;case 13:throw t.prev=13,t.t0=t["catch"](4),new Error(t.t0.message||"获取字典失败");case 16:return t.prev=16,t.abrupt("return",a);case 19:case"end":return t.stop()}}),t,null,[[4,13,16,19]])})))()}}}},"3bda":function(e,t,r){},"558b":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"apply-container container"},[t("AllOrderDetail",{attrs:{"order-detail":e.orderDetail,"approve-log-list":e.approveLogList,"dict-data":e.dictData,"is-show-operate-car":!0},on:{reselect:e.reselect,deleteCar:e.deleteCar}}),t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.addCar}},[e._v("添加车辆")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.dispatchReassignment}},[e._v("确认")])],1)],1)},a=[],i=r("2909"),c=r("c7eb"),s=r("1da1"),u=r("5530"),d=(r("99af"),r("d81d"),r("14d9"),r("c1f9"),r("d3b7"),r("a573"),r("ddb0"),r("f8b7")),o=r("f527"),l=r("2f62"),h=r("2211"),f=r("004f"),m={name:"ReassignmentOrder",mixins:[h["a"],f["a"]],data:function(){return{carPic:o["a"],orderDetail:{},approveLogList:[],type:"",dictIds:{statusDict:"1522830760585670657",hopeBrandDict:"101801"},dictData:{statusDict:"",hopeBrandDict:""},orderType:"",oldReqAssignments:[]}},computed:Object(u["a"])(Object(u["a"])({},Object(l["b"])("DispathOrder",["ChoiceVehicie","ChoiceDriver","CarPerfect"])),Object(l["b"])(["userInfo","reqAssignments"])),methods:{handleSystemCardDict:function(){var e=arguments,t=this;return Object(s["a"])(Object(c["a"])().mark((function r(){var n,a,i;return Object(c["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.length>0&&void 0!==e[0]?e[0]:{},r.t0=Object(c["a"])().keys(n);case 2:if((r.t1=r.t0()).done){r.next=13;break}return a=r.t1.value,r.next=6,t.getCommonDictList(n[a]);case 6:if(r.t2=r.sent,r.t2){r.next=9;break}r.t2=[];case 9:i=r.t2,t.dictData[a]=Object.fromEntries(i.map((function(e){return[e.code,e.name]}))),r.next=2;break;case 13:case"end":return r.stop()}}),r)})))()},getOrderDetail:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var r;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.$route.params.id,Object(d["f"])({id:r}).then((function(t){var r,n=t.data.list,a=void 0===n?[]:n,c=(null!==(r=a[0])&&void 0!==r?r:{})||{};e.oldReqAssignments=Object(i["a"])(c.reqAssignments),e.orderDetail=e.dealReqAssignments(c)||{}}));case 2:case"end":return t.stop()}}),t)})))()},addCar:function(){var e=this.reqAssignments.length;this.$router.push({name:"DispatchVehicle",params:this.$route.params,query:Object(u["a"])(Object(u["a"])({},this.$route.query),{},{reqAssignmentsIndex:e})})},dispatchReassignment:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var r,n,a,s;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$toast.loading({duration:0,message:"派单中..",forbidClick:!0}),n={status:e.orderDetail.status,fromAddr:e.orderDetail.fromAddr,toAddr:e.orderDetail.toAddr,id:e.orderDetail.id,phone:e.orderDetail.phone,createType:e.orderDetail.createType,usageDate:e.orderDetail.usageDate,usageTime:e.orderDetail.usageTime,handleUserId:e.orderDetail.handleUserId,handleUserName:e.orderDetail.handleUserName,handleUnit:e.orderDetail.handleUnit,handleUnitCode:e.orderDetail.handleUnitCode,reqAssignments:[]},a=[],e.oldReqAssignments.length&&(a=e.oldReqAssignments.map((function(e){return{beginMiles:e.beginMiles||"",carNumber:e.carNumber||"",driver:e.driver||"",driverId:e.driverId||"",driverPhone:e.driverPhone||"",id:e.id||"",vinNumber:e.vinNumber||"",restatus:1}}))),n.reqAssignments=e.orderDetail.reqAssignments.map((function(e){return{id:e.id,restatus:e.restatus,driver:e.driver,driverId:e.driverCode,driverPhone:e.phone,beginMiles:e.startMiles,carNumber:e.carNumber,vinNumber:e.vinNumber}})),n.reqAssignments=[].concat(Object(i["a"])(n.reqAssignments),Object(i["a"])(a)),t.prev=6,t.next=9,Object(o["o"])(n);case 9:s=t.sent,0===(null===s||void 0===s?void 0:s.code)?e.$store.dispatch("DispathOrder/removeReqAssignments").then((function(){e.$router.push({name:"DispathSuccess",params:{id:e.orderDetail.id}})})):e.$toast.fail((null===s||void 0===s?void 0:s.message)||"派单失败!，请重试"),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),e.$toast.fail("派单失败!，请重试");case 16:return t.prev=16,r.clear(),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[6,13,16,19]])})))()},dealReqAssignments:function(e){var t=this.reqAssignments.map((function(e){return Object(u["a"])(Object(u["a"])({},e.driverInfo),e.carInfo)}));return e["reqAssignments"]=t,e},reselect:function(e){var t=this.$route.query||{},r=t.reqAssignmentsIndex;this.$store.dispatch("DispathOrder/setCarAndDriverData",{undefined:void 0,reqAssignmentsIndex:r,setDataType:"carInfo"}),this.$store.dispatch("DispathOrder/setCarAndDriverData",{undefined:void 0,reqAssignmentsIndex:r,setDataType:"driverInfo"}),this.$router.push({name:"DispatchVehicle",params:this.$route.params,query:Object(u["a"])(Object(u["a"])({},this.$route.query),{},{reqAssignmentsIndex:e})})},deleteCar:function(e){var t=this;this.$store.dispatch("DispathOrder/deleteReqAssignmentsItem",e).then((function(){t.orderDetail=t.dealReqAssignments(t.orderDetail)||{}}))}},created:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.orderType=e.$route.query.orderType,e.handleSystemCardDict(e.dictIds),e.getOrderDetail();case 3:case"end":return t.stop()}}),t)})))()}},p=m,b=(r("73b3"),r("2877")),g=Object(b["a"])(p,n,a,!1,null,"b5ca9fdc",null);t["default"]=g.exports},"73b3":function(e,t,r){"use strict";r("3bda")},c1f9:function(e,t,r){"use strict";var n=r("23e7"),a=r("2266"),i=r("8418");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return a(e,(function(e,r){i(t,e,r)}),{AS_ENTRIES:!0}),t}})},f527:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"n",(function(){return u})),r.d(t,"g",(function(){return d})),r.d(t,"j",(function(){return o})),r.d(t,"p",(function(){return l})),r.d(t,"f",(function(){return h})),r.d(t,"r",(function(){return f})),r.d(t,"l",(function(){return m})),r.d(t,"h",(function(){return p})),r.d(t,"e",(function(){return b})),r.d(t,"o",(function(){return g})),r.d(t,"m",(function(){return v})),r.d(t,"b",(function(){return O})),r.d(t,"q",(function(){return j})),r.d(t,"i",(function(){return D})),r.d(t,"k",(function(){return q}));var n=r("b775"),a="",i=a+"/dispatch/carPic";function c(e){return Object(n["a"])({url:"/dispatch/dispatchList",method:"GET",params:e})}function s(e){return Object(n["a"])({url:"/dispatch/dispatchedList",method:"GET",params:e})}function u(e){return Object(n["a"])({url:"/dispatch/historyList",method:"GET",params:e})}function d(e){return Object(n["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:e})}function o(e){return Object(n["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:e})}function l(e){return Object(n["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:e})}function h(e){return Object(n["a"])({url:"/dispatch/reassignment",method:"POST",data:e})}function f(e,t){return Object(n["a"])({url:"/vehicleInfo/".concat(t?"getResAvailableCar":"getAvailableCar"),method:"get",params:e})}function m(e){return Object(n["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:e})}function p(e){return Object(n["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:e})}function b(e){return Object(n["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:e})}function g(e){return Object(n["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:e})}function v(e){return Object(n["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:e})}function O(e){return Object(n["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:e})}function j(e){return Object(n["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:e})}function D(e){return Object(n["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:e})}function q(e){return Object(n["a"])({url:"/dept/tree",method:"GET",params:e})}},f8b7:function(e,t,r){"use strict";r.d(t,"l",(function(){return a})),r.d(t,"m",(function(){return i})),r.d(t,"i",(function(){return c})),r.d(t,"j",(function(){return s})),r.d(t,"n",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return l})),r.d(t,"k",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return m})),r.d(t,"f",(function(){return p})),r.d(t,"h",(function(){return b})),r.d(t,"g",(function(){return g}));var n=r("b775");function a(e){return Object(n["a"])({url:"/order/getOrderDetail",method:"GET",params:e})}function i(e){return Object(n["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:e})}function c(e){return Object(n["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:e})}function s(e){return Object(n["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:e})}function u(e){return Object(n["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:e})}function d(e){return Object(n["a"])({url:"/activiti/assigneeList",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:e})}function l(e){return Object(n["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:e})}function h(e){return Object(n["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:e})}function f(e){return Object(n["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:e})}function m(e){return Object(n["a"])({url:"/activiti/assigneeListByType",method:"get",params:e})}function p(e){return Object(n["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:e})}function b(e){return Object(n["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:e})}function g(e){return Object(n["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:e})}}}]);