(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4767b791"],{"0c8f":function(t,e,n){"use strict";n("eb38")},"26c3":function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"e",(function(){return s})),n.d(e,"i",(function(){return u})),n.d(e,"g",(function(){return o})),n.d(e,"f",(function(){return d})),n.d(e,"h",(function(){return l})),n.d(e,"j",(function(){return h})),n.d(e,"a",(function(){return f})),n.d(e,"k",(function(){return m}));var r=n("b775");function a(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/listPage",method:"GET",params:t})}function i(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/listPage",method:"GET",params:t})}function c(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/driving/checkDriving",method:"GET",params:t})}function s(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/cancelOrder",method:"get",params:t})}function u(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/takeOrder",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/remind",method:"get",params:t})}function d(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/driving",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/gcywVehicleReqAssignmennt/returning",method:"post",data:t})}function h(t){return Object(r["a"])({url:"/minio/upload",method:"post",data:t})}function f(t){return Object(r["a"])({url:"/vehicleInfo/isRestriction",method:"get",params:t})}function m(t){return Object(r["a"])({url:"/vehicleInfo/detail/".concat(t),method:"get"})}},"45fc":function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").some,i=n("a640"),c=i("some");r({target:"Array",proto:!0,forced:!c},{some:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"9a9a":function(t,e,n){"use strict";n("a732")},a732:function(t,e,n){"use strict";var r=n("23e7"),a=n("2266"),i=n("59ed"),c=n("825a"),s=n("46c4");r({target:"Iterator",proto:!0,real:!0},{some:function(t){c(this),i(t);var e=s(this),n=0;return a(e,(function(e,r){if(t(e,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},a862:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail-container"},[e("div",{staticClass:"search-container"},[e("van-search",{class:{"inpu-focus":t.inputFocus},attrs:{placeholder:"车牌号/车型名称搜索",shape:"round"},on:{focus:function(e){t.inputFocus=!0},blur:function(e){t.inputFocus=!1},search:t.handleSearchClick,clear:t.handleInputClear,input:t.handleSearchInput},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),e("div",{staticClass:"screen-container"},[e("van-popover",{attrs:{trigger:"click",actions:t.actions},on:{select:t.maxMensSelect},scopedSlots:t._u([{key:"reference",fn:function(){return[e("span",{staticClass:"popover-title"},[t._v(t._s(t.maxMensTitle))]),e("van-icon",{attrs:{name:"arrow-down"}})]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})],1)],1),t._m(0),e("div",[e("van-list",{attrs:{offset:"30",finished:t.finished,"finished-text":"没有更多了..."},on:{load:t.getAvailableCar},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.carList,(function(n,r){return e("div",{key:r,staticClass:"car-item-container",on:{click:function(e){return t.handleCarClick(n)}}},[e("img",{attrs:{src:t.checkCarImagePath(n.carBrand,n.carSeries)}}),e("span",{staticClass:"car-number"},[t._v(t._s(n.carNumber))]),e("span",{staticClass:"car-brand"},[t._v(t._s(n.carBrand)+" "+t._s(n.carSeries))])])})),0)],1),e("div",{staticClass:"default-button-container-one"},[e("van-button",{attrs:{icon:"arrow-left",block:"",type:"default",round:""},on:{click:function(e){return t.handleCancel()}}},[t._v("上一步")])],1)])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"tip-container"},[e("span",[t._v("分派车辆时注意所在地限行法规")])])}],i=(n("4de4"),n("7db0"),n("4160"),n("caad"),n("14d9"),n("45fc"),n("f4b3"),n("e9c4"),n("b64b"),n("d3b7"),n("2532"),n("0643"),n("2382"),n("fffc"),n("4e3e"),n("9a9a"),n("159b"),n("f527")),c=n("26c3"),s=n("0b8e"),u={name:"DispatchVehicle",data:function(){return{loading:!1,finished:!1,searchText:"",inputFocus:!1,orderDetail:{},type:"",originalCarList:[],carList:[],showPopover:!1,maxMensTitle:"座位数",actions:[{text:"全部"},{text:"4-5人"},{text:"5-7人"},{text:"7人以上"}],currentAction:0,checkCarImagePath:s["a"]}},created:function(){if(this.orderDetail=JSON.parse(this.$route.params.obj),this.type=this.$route.params.type,"changeDispatch"==this.type){var t=this.orderDetail.reqAssignments.some((function(t){return t.restatus="1"}));t||this.orderDetail.reqAssignments.forEach((function(t){t.restatus="1"}))}},methods:{getAvailableCar:function(){var t=this,e=this.$toast.loading({duration:0,message:"加载中..",forbidClick:!0}),n={unitCode:this.orderDetail.unitCode,deptId:this.orderDetail.deptId,tunUnitCode:this.orderDetail.reassignUnitCode,usageDate:this.orderDetail.usageDate,reason:this.orderDetail.reasonCode};Object(i["r"])(n,this.orderDetail.reassignUnitCode).then((function(e){var n=e.data;t.loading=!0,t.finished=!0,t.carList=n,t.originalCarList=n})).catch((function(){})).finally((function(){e.clear()}))},viewCarIsDriving:function(t){var e=this,n=this.$toast.loading({duration:0,message:"加载中..",forbidClick:!0}),r={carNumber:t.carNumber,date:this.orderDetail.usageDate,cityId:this.orderDetail.fromAreaId.split(",")[1]};Object(c["a"])(r).then((function(n){var r=n.message;"操作成功"!=r&&e.$notify({type:"warning",message:"当前车辆限行，请重新选择!"}),e.orderDetail.reqAssignments.push(t),e.$router.push({name:"DispathDriver",params:{obj:JSON.stringify(e.orderDetail),type:e.type}})})).catch((function(t){})).finally((function(){n.clear()}))},handleSearchClick:function(){var t=this;0==this.currentAction?this.carList=this.originalCarList.filter((function(e){return e.carNumber.includes(t.searchText)||e.carBrand.includes(t.searchText)})):1==this.currentAction?this.carList=this.originalCarList.filter((function(e){return(e.carNumber.includes(t.searchText)||e.carBrand.includes(t.searchText))&&e.maxMens<=5&&e.maxMens>=4})):2==this.currentAction?this.carList=this.originalCarList.filter((function(e){return(e.carNumber.includes(t.searchText)||e.carBrand.includes(t.searchText))&&e.maxMens<=7&&e.maxMens>=5})):3==this.currentAction&&(this.carList=this.originalCarList.filter((function(e){return(e.carNumber.includes(t.searchText)||e.carBrand.includes(t.searchText))&&e.maxMens>7})))},maxMensSelect:function(t,e){this.maxMensTitle=t.text,this.currentAction=e,this.handleSearchClick()},handleInputClear:function(){this.handleSearchClick()},handleSearchInput:function(){this.searchText||this.handleSearchClick()},handleCarClick:function(t){var e=this.orderDetail.reqAssignments.find((function(e){return e.carNumber==t.carNumber&&"1"!=e.restatus}));e?this.$notify({type:"warning",message:"该车辆已经选择过，请重新选择!"}):this.viewCarIsDriving(t)},handleCancel:function(){this.$router.back()}}},o=u,d=(n("0c8f"),n("2877")),l=Object(d["a"])(o,r,a,!1,null,"00872d8b",null);e["default"]=l.exports},eb38:function(t,e,n){},f527:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"n",(function(){return u})),n.d(e,"g",(function(){return o})),n.d(e,"j",(function(){return d})),n.d(e,"p",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"r",(function(){return f})),n.d(e,"l",(function(){return m})),n.d(e,"h",(function(){return p})),n.d(e,"e",(function(){return g})),n.d(e,"o",(function(){return b})),n.d(e,"m",(function(){return v})),n.d(e,"b",(function(){return C})),n.d(e,"q",(function(){return O})),n.d(e,"i",(function(){return j})),n.d(e,"k",(function(){return T}));var r=n("b775"),a="",i=a+"/dispatch/carPic";function c(t){return Object(r["a"])({url:"/dispatch/dispatchList",method:"GET",params:t})}function s(t){return Object(r["a"])({url:"/dispatch/dispatchedList",method:"GET",params:t})}function u(t){return Object(r["a"])({url:"/dispatch/historyList",method:"GET",params:t})}function o(t){return Object(r["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:t})}function d(t){return Object(r["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:t})}function l(t){return Object(r["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:t})}function h(t){return Object(r["a"])({url:"/dispatch/reassignment",method:"POST",data:t})}function f(t,e){return Object(r["a"])({url:"/vehicleInfo/".concat(e?"getResAvailableCar":"getAvailableCar"),method:"get",params:t})}function m(t){return Object(r["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:t})}function p(t){return Object(r["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:t})}function g(t){return Object(r["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:t})}function b(t){return Object(r["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:t})}function v(t){return Object(r["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:t})}function C(t){return Object(r["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:t})}function O(t){return Object(r["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:t})}function j(t){return Object(r["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:t})}function T(t){return Object(r["a"])({url:"/dept/tree",method:"GET",params:t})}}}]);