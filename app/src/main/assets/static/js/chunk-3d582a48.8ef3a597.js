(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d582a48"],{"004f":function(e,t,r){"use strict";var n=r("c7eb"),a=r("1da1"),i=(r("d9e2"),r("d401"),r("b705"));t["a"]={data:function(){return{}},filters:{},computed:{},methods:{getCommonDictList:function(){var e=arguments;return Object(a["a"])(Object(n["a"])().mark((function t(){var r,a,s,c,o;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"",r){t.next=3;break}return t.abrupt("return");case 3:return a=[],t.prev=4,t.next=7,Object(i["a"])(r);case 7:s=t.sent,c=s.data,o=void 0===c?[]:c,a=o,t.next=16;break;case 13:throw t.prev=13,t.t0=t["catch"](4),new Error(t.t0.message||"获取字典失败");case 16:return t.prev=16,t.abrupt("return",a);case 19:case"end":return t.stop()}}),t,null,[[4,13,16,19]])})))()}}}},"2ebc":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"apply-container container"},[t("AllOrderDetail",{attrs:{"order-detail":e.orderDetail,"approve-log-list":e.approveLogList,"dict-data":e.dictData,"is-show-operate-car":!0},on:{reselect:e.reselect,deleteCar:e.deleteCar}}),t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.addCar}},[e._v("添加车辆")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.confirmOrderDispatch}},[e._v("确认")])],1)],1)},a=[],i=r("c7eb"),s=r("1da1"),c=r("5530"),o=(r("4160"),r("d81d"),r("14d9"),r("c1f9"),r("d3b7"),r("0643"),r("4e3e"),r("a573"),r("159b"),r("ddb0"),r("f527")),u=r("2f62"),d=r("2211"),h=r("004f"),l={name:"ConfirmDistribute",mixins:[d["a"],h["a"]],data:function(){return{carPic:o["a"],orderDetail:{},approveLogList:[],type:"",dictIds:{statusDict:"1522830760585670657",hopeBrandDict:"101801"},dictData:{statusDict:"",hopeBrandDict:""},orderType:""}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])("DispathOrder",["ChoiceVehicie","ChoiceDriver","CarPerfect"])),Object(u["b"])(["userInfo","reqAssignments"])),methods:{handleSystemCardDict:function(){var e=arguments,t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){var n,a,s;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.length>0&&void 0!==e[0]?e[0]:{},r.t0=Object(i["a"])().keys(n);case 2:if((r.t1=r.t0()).done){r.next=13;break}return a=r.t1.value,r.next=6,t.getCommonDictList(n[a]);case 6:if(r.t2=r.sent,r.t2){r.next=9;break}r.t2=[];case 9:s=r.t2,t.dictData[a]=Object.fromEntries(s.map((function(e){return[e.code,e.name]}))),r.next=2;break;case 13:case"end":return r.stop()}}),r)})))()},addCar:function(){var e=this.reqAssignments.length;this.$router.push({name:"DispatchVehicle",params:this.$route.params,query:Object(c["a"])(Object(c["a"])({},this.$route.query),{},{reqAssignmentsIndex:e})})},confirmOrderDispatch:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.confirmDistribute();case 1:case"end":return t.stop()}}),t)})))()},confirmDistribute:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r,n,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$toast.loading({duration:0,message:"提交中..",forbidClick:!0}),n=Object(c["a"])(Object(c["a"])({},e.orderDetail),{},{id:""}),n.reqAssignments=e.orderDetail.reqAssignments.map((function(e){return{id:e.id,status:e.status,driver:e.driver,driverId:e.driverCode,driverPhone:e.phone,beginMiles:e.startMiles,carNumber:e.carNumber,vinNumber:e.vinNumber}})),t.prev=3,t.next=6,Object(o["e"])(n);case 6:if(a=t.sent,0!==(null===a||void 0===a?void 0:a.code)){t.next=15;break}return t.next=10,e.$store.dispatch("DispathOrder/removeReqAssignments");case 10:return t.next=12,e.$store.dispatch("DispathOrder/triggerFefresh",!0);case 12:e.$router.push({name:"DispatchOrderList"}),t.next=16;break;case 15:e.$toast.fail((null===a||void 0===a?void 0:a.message)||"派单失败!，请重试");case 16:t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](3),e.$toast.fail("派单失败!，请重试");case 21:return t.prev=21,r.clear(),t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[3,18,21,24]])})))()},dealReqAssignments:function(e){var t=this.reqAssignments.map((function(e){return Object(c["a"])(Object(c["a"])({},e.driverInfo),e.carInfo)}));return e["reqAssignments"]=t,e},reselect:function(e){var t=this.$route.query||{},r=t.reqAssignmentsIndex;this.$store.dispatch("DispathOrder/setCarAndDriverData",{undefined:void 0,reqAssignmentsIndex:r,setDataType:"carInfo"}),this.$store.dispatch("DispathOrder/setCarAndDriverData",{undefined:void 0,reqAssignmentsIndex:r,setDataType:"driverInfo"}),this.$router.push({name:"DispatchVehicle",params:this.$route.params,query:Object(c["a"])(Object(c["a"])({},this.$route.query),{},{reqAssignmentsIndex:e})})},deleteCar:function(e){var t=this;this.$store.dispatch("DispathOrder/deleteReqAssignmentsItem",e).then((function(){t.orderDetail=t.dealReqAssignments(t.orderDetail)||{}}))},dealTreeListEmptyChildren:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.forEach((function(t){var r;null!==t&&void 0!==t&&null!==(r=t.children)&&void 0!==r&&r.length?e.dealTreeListEmptyChildren(t.children):delete t.children})),t},computedDetailData:function(e){var t=e.createType,r=void 0===t?"1":t,n=e.demandName,a=void 0===n?"":n,i=e.demandCode,s=e.deptId,c=e.deptName,o=e.fromAddr,u=e.fromAreaId,d=e.hopeBrand,h=e.longDistanceTag,l=e.phone,m=e.reasonName,f=e.reasonCode,p=void 0===f?"1":f,b=e.remark,v=e.reqAssignments,g=void 0===v?[]:v,O=e.source,j=void 0===O?"1":O,D=e.timeLength,A=e.toAddr,C=e.toAreaIdd,q=e.unitCode,w=e.unitName,y=e.usageDate,T=e.usagePersons,x=e.usageTime,k=e.userName;this.orderDetail={createType:r,demand:a,demandCode:i,deptId:s,deptName:c,fromAddr:o,fromAreaId:u,hopeBrand:d,longDistanceTag:h,phone:l,reason:m,reasonCode:p,remark:b,reqAssignments:g,source:j,timeLength:D,toAddr:A,toAreaIdd:C,unitCode:q,unitName:w,usageDate:y,usagePersons:T,usageTime:x,userName:k}}},created:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.orderType=e.$route.query.orderType,e.handleSystemCardDict(e.dictIds),r=Object(c["a"])(Object(c["a"])({},e.CarPerfect),e.ChoiceDriver),e.orderDetail=e.dealReqAssignments(r),e.computedDetailData(r);case 5:case"end":return t.stop()}}),t)})))()}},m=l,f=(r("7260"),r("2877")),p=Object(f["a"])(m,n,a,!1,null,"5f4cdce2",null);t["default"]=p.exports},7260:function(e,t,r){"use strict";r("75e1")},"75e1":function(e,t,r){},c1f9:function(e,t,r){"use strict";var n=r("23e7"),a=r("2266"),i=r("8418");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return a(e,(function(e,r){i(t,e,r)}),{AS_ENTRIES:!0}),t}})},f527:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"n",(function(){return o})),r.d(t,"g",(function(){return u})),r.d(t,"j",(function(){return d})),r.d(t,"p",(function(){return h})),r.d(t,"f",(function(){return l})),r.d(t,"r",(function(){return m})),r.d(t,"l",(function(){return f})),r.d(t,"h",(function(){return p})),r.d(t,"e",(function(){return b})),r.d(t,"o",(function(){return v})),r.d(t,"m",(function(){return g})),r.d(t,"b",(function(){return O})),r.d(t,"q",(function(){return j})),r.d(t,"i",(function(){return D})),r.d(t,"k",(function(){return A}));var n=r("b775"),a="",i=a+"/dispatch/carPic";function s(e){return Object(n["a"])({url:"/dispatch/dispatchList",method:"GET",params:e})}function c(e){return Object(n["a"])({url:"/dispatch/dispatchedList",method:"GET",params:e})}function o(e){return Object(n["a"])({url:"/dispatch/historyList",method:"GET",params:e})}function u(e){return Object(n["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:e})}function d(e){return Object(n["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:e})}function h(e){return Object(n["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:e})}function l(e){return Object(n["a"])({url:"/dispatch/reassignment",method:"POST",data:e})}function m(e,t){return Object(n["a"])({url:"/vehicleInfo/".concat(t?"getResAvailableCar":"getAvailableCar"),method:"get",params:e})}function f(e){return Object(n["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:e})}function p(e){return Object(n["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:e})}function b(e){return Object(n["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:e})}function v(e){return Object(n["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:e})}function g(e){return Object(n["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:e})}function O(e){return Object(n["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:e})}function j(e){return Object(n["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:e})}function D(e){return Object(n["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:e})}function A(e){return Object(n["a"])({url:"/dept/tree",method:"GET",params:e})}}}]);