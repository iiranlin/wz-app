(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e4d9b97"],{"2fa3":function(e,t,a){},"60f3":function(e,t,a){e.exports=a.p+"static/img/quxiao.b39f129e.svg"},"6a3f":function(e,t,a){"use strict";a("2fa3")},"74f3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"apply-container container"},[t("div",{staticClass:"wrapper"},["2"!=e.type&&"4"!=e.type?t("div",{staticClass:"order-top"},[t("span",[e._v("订单号："+e._s(e.orderDetail.sReqNo))]),t("van-tag",{attrs:{size:"large",round:"",type:"primary"}},[e._v(e._s(e.orderDetail.state))])],1):e._e(),"b"==e.orderDetail.stateCode?t("div",{staticClass:"reject-box"},[t("div",{staticClass:"reject-title"},[e._v("驳回原因：")]),t("van-notice-bar",{attrs:{scrollable:e.orderDetail.sRefuseReason.length>20,color:"#2e2e2e",background:"#fef9e9"}},[e._v(e._s(e.orderDetail.sRefuseReason||"未填写明确申请原因"))])],1):e._e(),"9"==e.orderDetail.stateCode?t("div",{staticClass:"reject-box"},[t("div",{staticClass:"reject-title"},[e._v("取消原因：")]),t("van-notice-bar",{attrs:{scrollable:e.orderDetail.sCancelReason.length>20,color:"#2e2e2e",background:"#f2f7fc"}},[e._v(e._s(e.orderDetail.sCancelReason||"未填写明确取消原因"))])],1):e._e(),"1"===e.type||"2"===e.type||"10"===e.type?t("div",{staticClass:"ChoiceVehicie"},[t("ul",[t("li",[t("img",{attrs:{src:e.carPic+"?carModel="+e.ChoiceVehicie.brand+" "+e.ChoiceVehicie.carType}})]),t("li",[t("h3",[e._v(e._s(e.ChoiceVehicie.carNumber))]),t("p",[e._v(e._s(e.ChoiceVehicie.brand))]),t("p",[e._v("司机："+e._s(e.ChoiceDriver.name)),t("span",{staticStyle:{color:"blue"},on:{click:function(t){return e.teleponeClick(e.ChoiceDriver.phone)}}},[e._v(e._s(e.ChoiceDriver.driverPhone))])])])])]):e._e(),"已派车"===e.orderDetail.state&&"0"===e.type||("4"===e.type||"5"===e.type)&&e.orderDetail.driverName||"3"===e.type?t("div",{staticClass:"ChoiceVehicie"},[t("ul",[t("li",[t("img",{attrs:{src:e.carPic+"?carModel="+e.orderDetail.brand+" "+e.orderDetail.cartype}})]),t("li",[t("h3",[e._v(e._s(e.orderDetail.sArrangedCar))]),t("p",[e._v(e._s(e.orderDetail.brand))]),t("p",[e._v("司机："+e._s(e.orderDetail.driverName)),t("span",{staticStyle:{color:"blue"},on:{click:function(t){return e.teleponeClick(e.orderDetail.driverPhone)}}},[e._v(e._s(e.orderDetail.dreverPhone))])])])])]):e._e(),t("ul",{staticClass:"info-box"},[t("li",{staticClass:"info-label"},[t("i",{staticClass:"font_family icon-icon-location-20"}),t("span",[e._v("出发地：")]),t("span",{staticClass:"info-address"},[e._v(e._s(e.orderDetail.sFromAddr))])]),t("li",{staticClass:"info-label"},[t("i",{staticClass:"icon font_family icon-icon-destination-20"}),t("span",[e._v("目的地：")]),t("span",{staticClass:"info-address"},[e._v(e._s(e.orderDetail.sTargetAddr))])]),t("li",{staticClass:"info-label"},[t("i",{staticClass:"icon font_family icon-icon-date-20"}),t("span",[e._v("时间：")]),t("span",[e._v(e._s(e.orderDetail.dDepartureTime))])])]),t("ul",{staticClass:"info-box"},[t("li",{staticClass:"info-label"},[t("i",{staticClass:"font_family icon-icon-mine-24"}),t("span",[e._v("乘车人：")]),t("span",[e._v(e._s(e.orderDetail.sPassenger))])]),t("li",{staticClass:"info-label"},[t("i",{staticClass:"icon font_family icon-icon-contacts-20"}),t("span",[e._v("电话：")]),t("span",[e._v(e._s(e.orderDetail.sPhone))])]),t("li",{staticClass:"info-label"},[t("i",{staticClass:"icon font_family icon-icon-company-20"}),t("span",[e._v("单位：")]),t("span",[e._v(e._s(e.orderDetail.companyName))])]),t("li",{staticClass:"info-label"},[t("i",{staticClass:"icon font_family icon-icon-department-20"}),t("span",[e._v("部门：")]),t("span",[e._v(e._s(e.orderDetail.deptName))])])]),t("ul",{staticClass:"info-text"},[t("li",{staticClass:"info-label"},[t("span",[e._v("用车事由：")]),t("span",[e._v(e._s(e._f("nReasonGo")(e.orderDetail.nReasonCode)))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("用车需求：")]),t("span",[e._v(e._s(e._f("nRangeGo")(e.orderDetail.nRangeCode)))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("用车时长：")]),t("span",[e._v(e._s(e.orderDetail.nAboutHours))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("是否长途：")]),t("span",[e._v(e._s(e.orderDetail.cLongDistance))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("期望车型：")]),t("span",[e._v(e._s(e.orderDetail.hopeCarType))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("实际车型：")]),t("span",{class:e.orderDetail.cartype===e.orderDetail.hopeCarType?"":"warnning"},[e._v(e._s(e.orderDetail.cartype))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("乘车人数：")]),t("span",[e._v(e._s(e.orderDetail.nPassenger))])]),t("li",{staticClass:"info-label"},[t("span",[e._v("备注：")]),t("span",{staticClass:"info-address"},[e._v(e._s(e.orderDetail.sRemark))])])]),"d"===e.orderDetail.stateCode||"7"===e.orderDetail.stateCode?[t("div",{staticClass:"log-title"},[e._v("行车信息")]),t("ul",{staticClass:"info-text"},[t("li",{staticClass:"info-label"},[t("span",[e._v("出车里程：")]),t("span",[e._v(e._s(e.orderDetail.startMiles||0)+" 千米")])]),t("li",{staticClass:"info-label"},[t("span",[e._v("还车里程：")]),t("span",[e._v(e._s(e.orderDetail.endMiles||0)+" 千米")])]),t("li",{staticClass:"info-label"},[t("span",[e._v("等待时长：")]),t("span",[e._v(e._s(e.orderDetail.waitTime||0)+" 小时")])]),t("li",{staticClass:"info-label"},[t("span",[e._v("行程描述：")]),t("span",{staticClass:"info-address"},[e._v(e._s(e.orderDetail.itineraryDescription||"行程描述"))])])])]:e._e(),t("div",{staticClass:"operlog-box"},[t("div",{staticClass:"log-title"},[e._v("审批日志")]),t("ul",{staticClass:"log-container"},e._l(e.apprlogList,(function(a,r){return t("li",{key:r,staticClass:"log-li"},[t("span",{staticClass:"log-time"},[e._v(e._s(e._f("timeAgo")(a.recordDate,"{m}/{d} {h}:{i}")))]),t("em",{staticClass:"log-cirle"}),t("span",{staticClass:"log-name"},[e._v(e._s(a.userName))]),t("span",{staticClass:"log-status"},[e._v(e._s(a.recordStep))])])})),0)])],2),e.userInfo.loginName==e.orderDetail.sOperator||"已派车"!==e.orderDetail.state&&"已领单"!==e.orderDetail.state&&"已出车"!==e.orderDetail.state?e._e():t("div",{staticClass:"form-button"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.CancelOrderChanges}},[e._v("取消订单")])],1),e.userInfo.loginName===e.orderDetail.sOperator?["0"===e.type?t("div",{staticClass:"button-box"},[t("div",{staticClass:"button-box-image"},[t("van-image",{attrs:{width:"100%",height:"20px",src:e.quxiao},on:{click:e.CancelOrderChanges}}),t("div",{staticClass:"text"},[e._v("取消订单")])],1),t("div",{staticClass:"button-box-image",on:{click:e.CopyOrderChange}},[t("van-image",{attrs:{width:"100%",height:"20px",src:e.fuzhi}}),t("div",{staticClass:"text"},[e._v("复制订单")])],1),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.distribute}},[e._v(e._s("已派车"===e.orderDetail.state?"改派":"派单"))])],1):e._e(),"1"===e.type?t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.returnDetails}},[e._v("重新选择")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.saveOrderDispatch}},[e._v("确认派单")])],1):e._e(),"2"===e.type||"4"===e.type?t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.returnDetails}},[e._v("上一步")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.saveOrderDispatch}},[e._v("确认派单")])],1):e._e(),"5"===e.type?t("div",{staticClass:"form-button"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.CopyOrderChange}},[e._v("复制订单")])],1):e._e(),"6"===e.type?t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.CopyOrderChange}},[e._v("复制订单")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.orderConfirmUserCar}},[e._v("确认用车")])],1):e._e()]:e._e(),"10"===e.type?[t("div",{staticClass:"button-box"},[t("van-button",{attrs:{block:"",type:"default"},on:{click:e.returnDetails}},[e._v("上一步")]),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.saveOrderDispatch}},[e._v("确认派单")])],1)]:e._e(),t("van-popup",{attrs:{position:"bottom"},model:{value:e.showCancel,callback:function(t){e.showCancel=t},expression:"showCancel"}},[t("div",{staticClass:"CancelOrder"},[t("p",[e._v("取消原因：")])]),t("van-field",{attrs:{rows:"2",autosize:{minHeight:100},type:"textarea",maxlength:"50",placeholder:"请输入取消原因","show-word-limit":"","label-width":"60px"},model:{value:e.cancelReason,callback:function(t){e.cancelReason=t},expression:"cancelReason"}}),t("van-button",{attrs:{block:"",type:"info"},on:{click:e.CancelOrderChange}},[e._v("取消订单")])],1)],2)},i=[],s=a("5530"),n=(a("14d9"),a("f8b7")),o=a("f527"),c=a("e9a7"),l=a.n(c),d=a("60f3"),u=a.n(d),h=a("2f62"),p=a("2211"),f={mixins:[p["a"]],data:function(){return{carPic:o["a"],quxiao:u.a,fuzhi:l.a,orderDetail:{},apprlogList:[],type:"0",showCancel:!1,cancelReason:""}},computed:Object(s["a"])(Object(s["a"])({},Object(h["b"])("details",["autoId","ChoiceVehicie","ChoiceDriver","Details","CarOneData","CarCopData"])),Object(h["b"])(["userInfo"])),methods:{orderConfirmUserCar:function(){var e=this,t=this.$route.params.autoId;this.dialogConfirm({message:"是否要确认用车?"},(function(a,r){"confirm"===a?Object(n["k"])({autoId:t}).then((function(t){t.data;e.$notify({type:"success",message:"确认用车成功!"}),r(),e.$router.push({name:"order"})})).catch((function(){r()})):r()}))},returnDetails:function(){this.$router.go(-1)},orderGetOrderDetail:function(){var e=this,t=this.$route.params.autoId;Object(n["l"])({autoId:t}).then((function(t){var a=t.data;e.orderDetail=a,e.$store.dispatch("details/setDetails",a)}))},orderApprovalLog:function(){var e=this,t=this.$route.params.autoId;Object(n["i"])({autoId:t}).then((function(t){var a=t.data;e.apprlogList=a}))},CancelOrderChanges:function(){this.showCancel=!0},CancelOrderChange:function(){this.cancelReason?this.$dialog.confirm({title:"提示",message:"是否要取消订单?",beforeClose:this.orderCancelOrder}):this.$notify({type:"warning",message:"请输入取消原因！"})},orderCancelOrder:function(e,t){var a=this,r=this.cancelReason,i=this.$route.params.autoId;if("confirm"===e)return Object(n["j"])({autoId:i,cancelReason:r}).then((function(e){a.$notify({type:"success",message:"取消成功!"}),t(),a.showCancel=!1,a.$router.go(-1)})),!1;t()},distribute:function(){this.$router.push({name:"ChoiceVehicie",params:{typeVehicie:"0"}})},saveOrderDispatch:function(){var e=this,t={};t="2"===this.type||"10"===this.type?{cLongDistance:"否"===this.orderDetail.cLongDistance?"N":"Y",confirmDate:"",confirmPeople:"",dDepartureTime:this.orderDetail.dDepartureTime,dWeek:"",dreverPhone:this.ChoiceDriver.phone,nAboutHours:this.orderDetail.nAboutHours,nAutoId:this.orderDetail.nAutoId,nPassenger:this.orderDetail.nPassenger,nRangeCode:this.orderDetail.nRangeCode,nReasonCode:this.orderDetail.nReasonCode,sArrangedCar:this.ChoiceVehicie.carNumber,sArrangedDriver:this.ChoiceDriver.id,sFromAddr:this.orderDetail.sFromAddr,sHopeCartype:this.orderDetail.sHopeCartype,sHopeDrever:"",sPassenger:this.orderDetail.sPassenger,sPhone:this.orderDetail.sPhone,sRefuseReason:"",sRemark:this.orderDetail.sRemark,sReqNo:this.orderDetail.sReqNo,sTargetAddr:this.orderDetail.sTargetAddr}:"4"===this.type?{cLongDistance:"否"===this.orderDetail.cLongDistance?"N":"Y",confirmDate:"",confirmPeople:"",dDepartureTime:this.orderDetail.dDepartureTime,dWeek:"",dreverPhone:this.orderDetail.dreverPhone,nAboutHours:this.orderDetail.nAboutHours,nPassenger:this.orderDetail.nPassenger,nRangeCode:this.orderDetail.nRangeCode,nReasonCode:this.orderDetail.nReasonCode,sArrangedCar:this.orderDetail.sArrangedCar,sArrangedDriver:this.orderDetail.sArrangedDriver,sFromAddr:this.orderDetail.sFromAddr,sHopeCartype:this.orderDetail.sHopeCartype,sHopeDrever:"",sPassenger:this.orderDetail.sPassenger,sPhone:this.orderDetail.sPhone,sRefuseReason:"",sRemark:this.orderDetail.sRemark,sTargetAddr:this.orderDetail.sTargetAddr}:{cLongDistance:"否"===this.orderDetail.cLongDistance?"N":"Y",confirmDate:"",confirmPeople:"",dDepartureTime:this.orderDetail.dDepartureTime,dWeek:"",dreverPhone:this.ChoiceDriver.phone,nAboutHours:this.orderDetail.nAboutHours,nAutoId:this.orderDetail.nAutoId,nPassenger:this.orderDetail.nPassenger,nRangeCode:this.orderDetail.nRangeCode,nReasonCode:this.orderDetail.nReasonCode,sArrangedCar:this.ChoiceVehicie.carNumber,sArrangedDriver:this.ChoiceDriver.id,sFromAddr:this.orderDetail.sFromAddr,sHopeCartype:this.orderDetail.sHopeCartype,sHopeDrever:"",sPassenger:this.orderDetail.sPassenger,sPhone:this.orderDetail.sPhone,sRefuseReason:"",sRemark:this.orderDetail.sRemark,sReqNo:this.orderDetail.sReqNo,sTargetAddr:this.orderDetail.sTargetAddr};var a=this.$toast.loading({duration:0,message:"提交中..",forbidClick:!0});this.CarOneData;"已派车"===this.orderDetail.state?Object(o["f"])(t).then((function(t){var r=t.data;a.clear(),e.$store.dispatch("CarApplication/clearOneDataAction"),e.$store.dispatch("details/setAutoId",r),e.$router.push({name:"subSuccess"})})).catch((function(t){e.$toast.fail("派单失败!")})):Object(o["p"])(t).then((function(t){var r=t.data;a.clear(),e.$store.dispatch("CarApplication/clearOneDataAction"),e.$store.dispatch("details/setAutoId",r),e.$router.push({name:"subSuccess"})})).catch((function(t){e.$toast.fail("派单失败!")}))},CopyOrderChange:function(){var e=this.$route.params.autoId;"已派车"===this.orderDetail.state||"已还车"===this.orderDetail.state||"已确认"===this.orderDetail.state?this.$router.push({name:"StartApplyings",params:{autoId:e,type:"1"}}):this.$router.push({name:"StartApplyings",params:{autoId:e,type:"0"}})}},created:function(){var e=this.$route.params.type;this.type=e,"2"!=e&&"4"!=e?(this.orderGetOrderDetail(),this.orderApprovalLog()):"4"===e?this.orderDetail=this.CarCopData:(this.Details.cLongDistance="Y"===this.Details.cLongDistance?"是":"否",this.orderDetail=this.Details)}},v=f,C=(a("6a3f"),a("2877")),D=Object(C["a"])(v,r,i,!1,null,"dd87629e",null);t["default"]=D.exports},e9a7:function(e,t,a){e.exports=a.p+"static/img/fuzhi.d5b25c42.svg"},f527:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"n",(function(){return c})),a.d(t,"g",(function(){return l})),a.d(t,"j",(function(){return d})),a.d(t,"p",(function(){return u})),a.d(t,"f",(function(){return h})),a.d(t,"r",(function(){return p})),a.d(t,"l",(function(){return f})),a.d(t,"h",(function(){return v})),a.d(t,"e",(function(){return C})),a.d(t,"o",(function(){return D})),a.d(t,"m",(function(){return m})),a.d(t,"b",(function(){return b})),a.d(t,"q",(function(){return g})),a.d(t,"i",(function(){return _})),a.d(t,"k",(function(){return y}));var r=a("b775"),i="",s=i+"/dispatch/carPic";function n(e){return Object(r["a"])({url:"/dispatch/dispatchList",method:"GET",params:e})}function o(e){return Object(r["a"])({url:"/dispatch/dispatchedList",method:"GET",params:e})}function c(e){return Object(r["a"])({url:"/dispatch/historyList",method:"GET",params:e})}function l(e){return Object(r["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:e})}function d(e){return Object(r["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:e})}function u(e){return Object(r["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:e})}function h(e){return Object(r["a"])({url:"/dispatch/reassignment",method:"POST",data:e})}function p(e,t){return Object(r["a"])({url:"/vehicleInfo/".concat(t?"getResAvailableCar":"getAvailableCar"),method:"get",params:e})}function f(e){return Object(r["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:e})}function v(e){return Object(r["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:e})}function C(e){return Object(r["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:e})}function D(e){return Object(r["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:e})}function m(e){return Object(r["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:e})}function b(e){return Object(r["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:e})}function g(e){return Object(r["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:e})}function _(e){return Object(r["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:e})}function y(e){return Object(r["a"])({url:"/dept/tree",method:"GET",params:e})}},f8b7:function(e,t,a){"use strict";a.d(t,"l",(function(){return i})),a.d(t,"m",(function(){return s})),a.d(t,"i",(function(){return n})),a.d(t,"j",(function(){return o})),a.d(t,"n",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"k",(function(){return h})),a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return f})),a.d(t,"f",(function(){return v})),a.d(t,"h",(function(){return C})),a.d(t,"g",(function(){return D}));var r=a("b775");function i(e){return Object(r["a"])({url:"/order/getOrderDetail",method:"GET",params:e})}function s(e){return Object(r["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:e})}function n(e){return Object(r["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:e})}function o(e){return Object(r["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:e})}function c(e){return Object(r["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:e})}function l(e){return Object(r["a"])({url:"/activiti/assigneeList",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:e})}function u(e){return Object(r["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:e})}function h(e){return Object(r["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:e})}function p(e){return Object(r["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/activiti/assigneeListByType",method:"get",params:e})}function v(e){return Object(r["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:e})}function C(e){return Object(r["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:e})}function D(e){return Object(r["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:e})}}}]);