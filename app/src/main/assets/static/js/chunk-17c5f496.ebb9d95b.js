(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17c5f496"],{"2b91":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail-container"},[e("div",{staticClass:"from-container box-container"},[t._m(0),e("van-field",{attrs:{readonly:"","right-icon":"arrow","input-align":"right",clickable:"",name:"sFromAddr",label:"省/市/区：",placeholder:"请选择省市区"},on:{click:function(e){t.showsFormArea=!0}},model:{value:t.formData.sFromAddr,callback:function(e){t.$set(t.formData,"sFromAddr",e)},expression:"formData.sFromAddr"}}),e("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.showsFormArea,callback:function(e){t.showsFormArea=e},expression:"showsFormArea"}},[e("van-cascader",{attrs:{title:"请选择所在地区",options:t.provinceOptions,"field-names":t.fieldNames},on:{close:function(e){t.showsFormArea=!1},change:t.onFromChange,finish:t.onFromFinish},model:{value:t.formData.sFromAddrActive,callback:function(e){t.$set(t.formData,"sFromAddrActive",e)},expression:"formData.sFromAddrActive"}})],1),e("van-field",{attrs:{name:"sFromAddrDetail",label:"详细地址：",maxlength:"50","input-align":"right",clearable:"",placeholder:"请输入街道名称、门牌号"},model:{value:t.formData.sFromAddrDetail,callback:function(e){t.$set(t.formData,"sFromAddrDetail",e)},expression:"formData.sFromAddrDetail"}}),e("div",{staticClass:"address-container"},[e("div",{staticClass:"address-list",on:{click:function(e){return t.handleListClick("1")}}},[e("i"),e("span",[t._v("地址列表")])]),e("div",{staticClass:"address-set-default",on:{click:function(e){return t.handleSetDefaultClick("1")}}},[e("i"),e("span",[t._v("设为默认")])])])],1),e("div",{staticClass:"to-container box-container"},[t._m(1),e("van-field",{attrs:{readonly:"","right-icon":"arrow","input-align":"right",clickable:"",name:"sTargetAddr",label:"省/市/区：",placeholder:"请选择省市区"},on:{click:function(e){t.showsTargetArea=!0}},model:{value:t.formData.sTargetAddr,callback:function(e){t.$set(t.formData,"sTargetAddr",e)},expression:"formData.sTargetAddr"}}),e("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.showsTargetArea,callback:function(e){t.showsTargetArea=e},expression:"showsTargetArea"}},[e("van-cascader",{attrs:{title:"请选择所在地区",options:t.provinceOptions,"field-names":t.fieldNames},on:{close:function(e){t.showsTargetArea=!1},change:t.onTargetChange,finish:t.onTargetFinish},model:{value:t.formData.sTargetAddrActive,callback:function(e){t.$set(t.formData,"sTargetAddrActive",e)},expression:"formData.sTargetAddrActive"}})],1),e("van-field",{attrs:{name:"sTargetAddrDetail",label:"详细地址：",maxlength:"50","input-align":"right",clearable:"",placeholder:"请输入街道名称、门牌号"},model:{value:t.formData.sTargetAddrDetail,callback:function(e){t.$set(t.formData,"sTargetAddrDetail",e)},expression:"formData.sTargetAddrDetail"}}),e("div",{staticClass:"address-container"},[e("div",{staticClass:"address-list",on:{click:function(e){return t.handleListClick("2")}}},[e("i"),e("span",[t._v("地址列表")])]),e("div",{staticClass:"address-set-default",on:{click:function(e){return t.handleSetDefaultClick("2")}}},[e("i"),e("span",[t._v("设为默认")])])])],1),e("div",{staticClass:"date-container box-container"},[t._m(2),e("van-field",{attrs:{readonly:"","right-icon":"arrow","input-align":"center",clickable:"",name:"sTargetAddr",placeholder:"请选择出发日期"},on:{click:function(e){t.showsTimeArea=!0}},model:{value:t.formData.dDepartureTime,callback:function(e){t.$set(t.formData,"dDepartureTime",e)},expression:"formData.dDepartureTime"}}),e("div",{staticClass:"number-container"},[e("ul",[e("li",{staticClass:"total-number"},[e("span",[t._v(t._s(t.carTotalCount))]),e("span",{staticClass:"des"},[t._v("车辆总数")])]),e("li",{staticClass:"subscribe-number"},[e("span",[t._v(t._s(t.carSubscribeCount))]),e("span",{staticClass:"des"},[t._v("已预约")])]),e("li",{staticClass:"accept-number"},[e("span",[t._v(t._s(t.carAcceptCount))]),e("span",{staticClass:"des"},[t._v("已受理")])]),e("li",{staticClass:"uable-number"},[e("span",[t._v(t._s(t.carUsableCount))]),e("span",[t._v("可用车辆")])])])]),e("van-calendar",{attrs:{"min-date":new Date},on:{confirm:t.timeAreaConfirm},model:{value:t.showsTimeArea,callback:function(e){t.showsTimeArea=e},expression:"showsTimeArea"}})],1),e("div",{staticClass:"time-container box-container"},[t._m(3),e("van-field",{attrs:{readonly:"","right-icon":"arrow","input-align":"center",clickable:"",name:"sTargetAddr",placeholder:"请选择出发时间"},on:{click:function(e){t.showsTimeDetail=!0}},model:{value:t.formData.dDepartureTimeDetail,callback:function(e){t.$set(t.formData,"dDepartureTimeDetail",e)},expression:"formData.dDepartureTimeDetail"}}),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showsTimeDetail,callback:function(e){t.showsTimeDetail=e},expression:"showsTimeDetail"}},[e("van-datetime-picker",{attrs:{type:"time",filter:t.timefilter},on:{confirm:t.timeDetailConfirm,cancel:function(e){t.showsTimeDetail=!1},change:t.onTimeChange},model:{value:t.formData.dDepartureTimeDetail,callback:function(e){t.$set(t.formData,"dDepartureTimeDetail",e)},expression:"formData.dDepartureTimeDetail"}})],1)],1),e("div",{staticClass:"default-button-container-one"},[e("van-button",{attrs:{block:"",type:"info",round:""},on:{click:t.handleNextClick}},[t._v("下一步")])],1)])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-container"},[e("i"),e("span",[t._v("出发地")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-container"},[e("i"),e("span",[t._v("目的地")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-container"},[e("i"),e("span",[t._v("出发日期")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-container"},[e("i"),e("span",[t._v("出发时间")])])}],n=a("c7eb"),s=a("1da1"),o=(a("4de4"),a("7db0"),a("4160"),a("a15b"),a("d81d"),a("14d9"),a("d3b7"),a("2ca0"),a("0643"),a("2382"),a("fffc"),a("4e3e"),a("a573"),a("159b"),a("7d31")),c=a("f8b7"),d=a("f527"),u=a("ed08"),l=a("986e"),f=a("fd99"),m={name:"StartApplying",mixins:[f["a"]],data:function(){return{id:"",carUsableCount:0,carTotalCount:0,carSubscribeCount:0,carAcceptCount:0,formData:{fromId:"",targetId:"",sFromAddrActive:"",sTargetAddrActive:"",sFromAddrDetail:"",sTargetAddrDetail:"",dDepartureTimeDetail:"",sFromAddr:"",sTargetAddr:"",dDepartureTime:"",fromProvinceId:"",fromCityId:"",fromAreaId:"",targetProvinceId:"",targetCityId:"",targetAreaId:""},showsFormArea:!1,showsTargetArea:!1,showsTimeArea:!1,showsTimeDetail:!1,provinceOptions:[],cityOptions:[],areaOptions:[],fieldNames:{text:"divisionName",value:"divisionId",children:"children"}}},created:function(){var t=this;this.id=this.$route.params.id,"0"===this.id?(this.$nextTick((function(){t.formData.dDepartureTime=Object(u["e"])(Date.now(),"{y}-{m}-{d}"),t.initUsageTime()})),this.getProvinceOptions(0),this.getDefaultAddress(),this.$store.dispatch("CarApplication/clearCopyDataAction")):this.orderGetOrderDetail(),l["a"].$off("defaultAddress"),l["a"].$on("defaultAddress",function(t){this.setFromAndTargetAddress(t)}.bind(this))},methods:{getDefaultAddress:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["b"])({defualtTag:"1"}).then((function(e){var a=e.data;a.forEach((function(e){t.setFromAndTargetAddress(e)}))})).catch((function(t){}));case 2:case"end":return e.stop()}}),e)})))()},getProvinceOptions:function(t){var e=this;return Object(s["a"])(Object(n["a"])().mark((function a(){return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["c"])({pid:t}).then((function(t){var a=t.data;e.provinceOptions=a.list})).catch((function(t){}));case 2:case"end":return a.stop()}}),a)})))()},getCityOptions:function(t,e){var a=this;return Object(s["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(o["c"])({pid:t}).then((function(t){var r=t.data;a.cityOptions=r.list,a.provinceOptions.forEach((function(t){"from"===e?t.divisionId===a.formData.fromProvinceId&&a.$set(t,"children",a.cityOptions):t.divisionId===a.formData.targetProvinceId&&a.$set(t,"children",a.cityOptions)}))})).catch((function(t){}));case 2:case"end":return r.stop()}}),r)})))()},getAreaOptions:function(t,e){var a=this;return Object(s["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(o["c"])({pid:t}).then((function(t){var r=t.data;a.areaOptions=r.list;var i=a.provinceOptions.find((function(t){return"from"===e?t.divisionId===a.formData.fromProvinceId:t.divisionId===a.formData.targetProvinceId}));i.children.forEach((function(t){"from"===e?t.divisionId===a.formData.fromCityId&&a.$set(t,"children",a.areaOptions):t.divisionId===a.formData.targetCityId&&a.$set(t,"children",a.areaOptions)}))})).catch((function(t){}));case 2:case"end":return r.stop()}}),r)})))()},getCarCount:function(t){var e=this;Object(d["j"])({usageDate:t}).then((function(t){var a=t.data;0!=a.length?(e.carTotalCount=a[0].tasscount,e.carSubscribeCount=a[0].nasscount,e.carAcceptCount=a[0].sasscount,e.carUsableCount=a[0].tasscount-a[0].nasscount-a[0].sasscount):(e.carTotalCount=0,e.carSubscribeCount=0,e.carAcceptCount=0,e.carUsableCount=0)}))},initUsageTime:function(){var t=(new Date).getHours(),e=(new Date).getMinutes(),a=e%5;0!==a&&(a=5-a),e<55?e=e+a+5:55===e?(e=0,t+=1):(e=5,t+=1),e<10&&(e="0"+e),60==e&&(e="00",t+=1),t<10&&(t="0"+t),24==t&&(t="00"),this.formData.dDepartureTimeDetail=t+":"+e,this.getCarCount(this.formData.dDepartureTime)},onTimeChange:function(t){var e=t.getValues();e[0].startsWith("0")&&(e[0]=e[0].substr(1))},timefilter:function(t,e){return"minute"===t?e.filter((function(t){return t%5===0})):e},timeAreaConfirm:function(t){this.formData.dDepartureTime=Object(u["e"])(t,"{y}-{m}-{d}"),this.showsTimeArea=!1,this.getCarCount(this.formData.dDepartureTime)},timeDetailConfirm:function(t){this.formData.dDepartureTimeDetail=t,this.showsTimeDetail=!1},orderGetOrderDetail:function(){var t=this,e=this.$toast.loading({duration:0,message:"正在加载...",forbidClick:!0}),a={id:this.id};Object(c["f"])(a).then((function(e){var a,r=e.data;if(!((null===r||void 0===r||null===(a=r.list)||void 0===a?void 0:a.length)<=0)){var i=r.list[0];t.formData.sFromAddrActive=i.fromAreaId.split(",")[2],t.formData.sTargetAddrActive=i.toAreaIdd.split(",")[2],t.formData.sFromAddrDetail=i.fromAddr.split(" ")[1],t.formData.sTargetAddrDetail=i.toAddr.split(" ")[1],t.formData.dDepartureTime=Object(u["e"])(Date.now(),"{y}-{m}-{d}"),t.formData.sFromAddr=i.fromAddr.split(" ")[0],t.formData.sTargetAddr=i.toAddr.split(" ")[0],t.formData.fromProvinceId=i.fromAreaId.split(",")[0],t.formData.fromCityId=i.fromAreaId.split(",")[1],t.formData.fromAreaId=i.fromAreaId.split(",")[2],t.formData.targetProvinceId=i.toAreaIdd.split(",")[0],t.formData.targetCityId=i.toAreaIdd.split(",")[1],t.formData.targetAreaId=i.toAreaIdd.split(",")[2],t.$store.dispatch("CarApplication/setCopyDataAction",i),t.getProvinceOptions(0),t.initUsageTime()}})).catch((function(t){})).finally((function(){e.clear()}))},onFromChange:function(t){var e=t.value,a=(t.selectedOptions,t.tabIndex);0===a?(this.getCityOptions(e,"from"),this.formData.fromProvinceId=e):1===a?(this.getAreaOptions(e,"from"),this.formData.fromCityId=e):2===a&&(this.formData.fromAreaId=e)},onFromFinish:function(t){t.value;var e=t.selectedOptions,a=t.tabIndex;2===a&&(this.showsFormArea=!1,this.formData.sFromAddr=e.map((function(t){return t.divisionName})).join("/"))},onTargetChange:function(t){var e=t.value,a=(t.selectedOptions,t.tabIndex);0===a?(this.getCityOptions(e,"target"),this.formData.targetProvinceId=e):1===a?(this.getAreaOptions(e,"target"),this.formData.targetCityId=e):2===a&&(this.formData.targetAreaId=e)},onTargetFinish:function(t){t.value;var e=t.selectedOptions,a=t.tabIndex;2===a&&(this.showsTargetArea=!1,this.formData.sTargetAddr=e.map((function(t){return t.divisionName})).join("/"))},handleSetDefaultClick:function(t){var e=this,a={id:"1"===t?this.formData.fromId:this.formData.targetId,deleteTag:"0",defualtTag:"1",name:"",address:"1"===t?this.formData.sFromAddrDetail:this.formData.sTargetAddrDetail,provinceId:"1"===t?this.formData.fromProvinceId:this.formData.targetProvinceId,cityId:"1"===t?this.formData.fromCityId:this.formData.targetCityId,areaId:"1"===t?this.formData.fromAreaId:this.formData.targetAreaId,addressType:t,areaLongName:"1"===t?this.formData.sFromAddr:this.formData.sTargetAddr};Object(o["a"])(Object.assign({},a)).then((function(t){var a=t.message;e.$notify({type:"success",message:a})})).catch((function(t){}))},setFromAndTargetAddress:function(t){"1"===t.addressType?(this.formData.fromId=t.id,this.formData.sFromAddr=t.areaLongName,this.formData.sFromAddrDetail=t.address,this.formData.sFromAddrActive=t.areaId,this.formData.fromProvinceId=t.provinceId,this.formData.fromCityId=t.cityId,this.formData.fromAreaId=t.areaId):"2"===t.addressType&&(this.formData.targetId=t.id,this.formData.sTargetAddr=t.areaLongName,this.formData.sTargetAddrDetail=t.address,this.formData.sTargetAddrActive=t.areaId,this.formData.targetProvinceId=t.provinceId,this.formData.targetCityId=t.cityId,this.formData.targetAreaId=t.areaId)},handleListClick:function(t){this.$router.push({name:"DefaultAddress",params:{addressType:t}})},handleNextClick:function(){var t=this;this.formData.sFromAddr?this.formData.sFromAddrDetail?this.formData.sTargetAddr?this.formData.sTargetAddrDetail?this.formData.dDepartureTime?this.formData.dDepartureTimeDetail?this.$store.dispatch("CarApplication/setOneDataAction",this.formData).then((function(){t.$router.push({name:"PerfectInfo",query:{}})})):this.$notify({type:"warning",message:"请选择出发时间"}):this.$notify({type:"warning",message:"请选择出发日期"}):this.$notify({type:"warning",message:"请填写目的地详细地址!"}):this.$notify({type:"warning",message:"请选择目的地省市区!"}):this.$notify({type:"warning",message:"请填写出发地详细地址!"}):this.$notify({type:"warning",message:"请选择出发地省市区!"})}}},h=m,p=(a("522b"),a("2877")),g=Object(p["a"])(h,r,i,!1,null,"74f3cd28",null);e["default"]=g.exports},"2ca0":function(t,e,a){"use strict";var r=a("23e7"),i=a("4625"),n=a("06cf").f,s=a("50c4"),o=a("577e"),c=a("5a34"),d=a("1d80"),u=a("ab13"),l=a("c430"),f=i("".slice),m=Math.min,h=u("startsWith"),p=!l&&!h&&!!function(){var t=n(String.prototype,"startsWith");return t&&!t.writable}();r({target:"String",proto:!0,forced:!p&&!h},{startsWith:function(t){var e=o(d(this));c(t);var a=s(m(arguments.length>1?arguments[1]:void 0,e.length)),r=o(t);return f(e,a,a+r.length)===r}})},"522b":function(t,e,a){"use strict";a("b2e7")},"7d31":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return s}));var r=a("b775");function i(t){return Object(r["a"])({url:"/gcjcCommonAddress/listAll",method:"GET",params:t})}function n(t){return Object(r["a"])({url:"/gcjcCommonAddress/saveorupdate",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/gcjcDivision/list",method:"get",params:t})}},"986e":function(t,e,a){"use strict";var r=a("2b0e"),i=new r["d"]({});e["a"]=i},b2e7:function(t,e,a){},f527:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"n",(function(){return c})),a.d(e,"g",(function(){return d})),a.d(e,"j",(function(){return u})),a.d(e,"p",(function(){return l})),a.d(e,"f",(function(){return f})),a.d(e,"r",(function(){return m})),a.d(e,"l",(function(){return h})),a.d(e,"h",(function(){return p})),a.d(e,"e",(function(){return g})),a.d(e,"o",(function(){return v})),a.d(e,"m",(function(){return D})),a.d(e,"b",(function(){return b})),a.d(e,"q",(function(){return A})),a.d(e,"i",(function(){return T})),a.d(e,"k",(function(){return O}));var r=a("b775"),i="",n=i+"/dispatch/carPic";function s(t){return Object(r["a"])({url:"/dispatch/dispatchList",method:"GET",params:t})}function o(t){return Object(r["a"])({url:"/dispatch/dispatchedList",method:"GET",params:t})}function c(t){return Object(r["a"])({url:"/dispatch/historyList",method:"GET",params:t})}function d(t){return Object(r["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:t})}function u(t){return Object(r["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:t})}function l(t){return Object(r["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:t})}function f(t){return Object(r["a"])({url:"/dispatch/reassignment",method:"POST",data:t})}function m(t,e){return Object(r["a"])({url:"/vehicleInfo/".concat(e?"getResAvailableCar":"getAvailableCar"),method:"get",params:t})}function h(t){return Object(r["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:t})}function p(t){return Object(r["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:t})}function g(t){return Object(r["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:t})}function v(t){return Object(r["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:t})}function D(t){return Object(r["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:t})}function b(t){return Object(r["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:t})}function A(t){return Object(r["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:t})}function T(t){return Object(r["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:t})}function O(t){return Object(r["a"])({url:"/dept/tree",method:"GET",params:t})}},f8b7:function(t,e,a){"use strict";a.d(e,"l",(function(){return i})),a.d(e,"m",(function(){return n})),a.d(e,"i",(function(){return s})),a.d(e,"j",(function(){return o})),a.d(e,"n",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"e",(function(){return l})),a.d(e,"k",(function(){return f})),a.d(e,"c",(function(){return m})),a.d(e,"a",(function(){return h})),a.d(e,"f",(function(){return p})),a.d(e,"h",(function(){return g})),a.d(e,"g",(function(){return v}));var r=a("b775");function i(t){return Object(r["a"])({url:"/order/getOrderDetail",method:"GET",params:t})}function n(t){return Object(r["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:t})}function s(t){return Object(r["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:t})}function o(t){return Object(r["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:t})}function c(t){return Object(r["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:t})}function d(t){return Object(r["a"])({url:"/activiti/assigneeList",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:t})}function l(t){return Object(r["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:t})}function f(t){return Object(r["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:t})}function m(t){return Object(r["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:t})}function h(t){return Object(r["a"])({url:"/activiti/assigneeListByType",method:"get",params:t})}function p(t){return Object(r["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:t})}function g(t){return Object(r["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:t})}function v(t){return Object(r["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:t})}},fd99:function(t,e,a){"use strict";e["a"]={created:function(){this.$options.name||console.warn("缓存页面失败！没有设置组件名！"),this.$store.commit("keepThisPage",this.$options.name)},beforeDestroy:function(){}}}}]);