(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-055364ac"],{"1e4f":function(e,t,n){},"3abc":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"detail-container"},[t("div",{staticClass:"address-container box-container"},[t("ul",[t("li",[t("i"),t("span",[e._v("出发地：")]),t("span",[e._v(e._s(e.form.fromAddr))])]),t("li",[t("i"),t("span",[e._v("目的地：")]),t("span",[e._v(e._s(e.form.toAddr))])]),t("li",[t("i"),t("span",[e._v("时"+e._s("　")+"间：")]),t("span",[e._v(e._s(e.form.usageDate)+" "+e._s(e.form.usageTime))])])])]),t("div",{staticClass:"form-container box-container"},[t("ul",[t("li",[t("van-field",{attrs:{name:"guarantee",readonly:"","right-icon":"arrow","input-align":"right",clickable:"",label:"优先保障：",placeholder:"点击选择优先保障类型"},on:{click:function(t){e.sGuaranteePicker=!0}},model:{value:e.form.guaranteeName,callback:function(t){e.$set(e.form,"guaranteeName",t)},expression:"form.guaranteeName"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.sGuaranteePicker,callback:function(t){e.sGuaranteePicker=t},expression:"sGuaranteePicker"}},[t("van-picker",{attrs:{"show-toolbar":"","value-key":"name","default-index":e.sGuaranteeActiveIndex,columns:e.dictGuarantee},on:{confirm:e.sGuaranteeConfirm,cancel:function(t){e.sGuaranteePicker=!1}}})],1)],1),t("li",[t("van-field",{attrs:{name:"reason",readonly:"","right-icon":"arrow","input-align":"right",clickable:"",label:"用车事由：",placeholder:"点击选择用车事由"},on:{click:function(t){e.nReasonShowPicker=!0}},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.nReasonShowPicker,callback:function(t){e.nReasonShowPicker=t},expression:"nReasonShowPicker"}},[t("van-picker",{attrs:{"show-toolbar":"","value-key":"name","default-index":e.nReasonActiveIndex,columns:e.dictReqReason},on:{confirm:e.nReasonConfirm,cancel:function(t){e.nReasonShowPicker=!1}}})],1)],1),t("li",[t("van-field",{attrs:{name:"demand",readonly:"","right-icon":"arrow","input-align":"right",clickable:"",label:"用车需求：",placeholder:"点击选择用车需求"},on:{click:function(t){e.nRangeShowPicker=!0}},model:{value:e.form.demand,callback:function(t){e.$set(e.form,"demand",t)},expression:"form.demand"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.nRangeShowPicker,callback:function(t){e.nRangeShowPicker=t},expression:"nRangeShowPicker"}},[t("van-picker",{attrs:{"show-toolbar":"","value-key":"name","default-index":e.nRangeActiveIndex,columns:e.dictReqRange},on:{confirm:e.nRangeConfirm,cancel:function(t){e.nRangeShowPicker=!1}}})],1)],1),t("li",{staticClass:"li-edit-unit"},[t("van-field",{attrs:{name:"timeLength","input-align":"right",type:"digit",label:"用车时长：",clearable:"",placeholder:"请输入用车时长"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("span",[e._v("小时")])]},proxy:!0}]),model:{value:e.form.timeLength,callback:function(t){e.$set(e.form,"timeLength",t)},expression:"form.timeLength"}})],1),t("li",[t("van-field",{attrs:{name:"longDistanceTag",label:"是否长途："},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-radio-group",{staticClass:"longDistanceTag-group",attrs:{direction:"horizontal"},model:{value:e.form.longDistanceTag,callback:function(t){e.$set(e.form,"longDistanceTag",t)},expression:"form.longDistanceTag"}},[t("van-radio",{attrs:{name:"1"},scopedSlots:e._u([{key:"icon",fn:function(n){return[t("img",{staticClass:"img-icon",attrs:{src:n.checked?e.activeIcon:e.inactiveIcon}})]}}])},[e._v("是 ")]),t("van-radio",{attrs:{name:"0"},scopedSlots:e._u([{key:"icon",fn:function(n){return[t("img",{staticClass:"img-icon",attrs:{src:n.checked?e.activeIcon:e.inactiveIcon}})]}}])},[e._v("否 ")])],1)]},proxy:!0}])})],1),t("li",{staticClass:"li-edit"},[t("van-field",{attrs:{name:"userName","input-align":"right",clearable:"",maxlength:"50",label:"乘车人：",placeholder:"请输入乘车人"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),t("li",{staticClass:"li-edit"},[t("van-field",{attrs:{name:"phone","input-align":"right",clearable:"",type:"tel",label:"联系电话：",placeholder:"请输入联系电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("li",[t("van-field",{attrs:{name:"hopeBrand",readonly:"","right-icon":"arrow","input-align":"right",clickable:"",label:"期望车型：",placeholder:"点击选择期望车型"},on:{click:function(t){e.sHopeCartyPicker=!0}},model:{value:e.form.hopeBrandName,callback:function(t){e.$set(e.form,"hopeBrandName",t)},expression:"form.hopeBrandName"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.sHopeCartyPicker,callback:function(t){e.sHopeCartyPicker=t},expression:"sHopeCartyPicker"}},[t("van-picker",{attrs:{"show-toolbar":"","value-key":"name","default-index":e.sHopeCartyActiveIndex,columns:e.dictModelType},on:{confirm:e.sHopeCartyConfirm,cancel:function(t){e.sHopeCartyPicker=!1}}})],1)],1),t("li",{staticClass:"li-edit-unit"},[t("van-field",{attrs:{name:"usagePersons",type:"digit","input-align":"right",clearable:"",label:"乘坐人数：",maxlength:"2",placeholder:"请输入乘坐人数"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("span",[e._v("人")])]},proxy:!0}]),model:{value:e.form.usagePersons,callback:function(t){e.$set(e.form,"usagePersons",t)},expression:"form.usagePersons"}})],1),t("li",{staticClass:"li-item-remark"},[t("van-field",{staticClass:"form-textarea",attrs:{name:"remark",label:"备注：",rows:"3",autosize:"",type:"textarea",maxlength:"100",placeholder:"请输入备注","show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)])]),t("div",{staticClass:"default-button-container-one"},[t("van-button",{attrs:{block:"",type:"info",round:""},on:{click:e.handleConfirmClick}},[e._v("提交")])],1),t("van-popup",{attrs:{position:"bottom"},model:{value:e.assigneeShow,callback:function(t){e.assigneeShow=t},expression:"assigneeShow"}},[t("div",{staticClass:"popup-title"},[t("span",[e._v("请选择审批人")]),t("van-button",{staticClass:"more-button",attrs:{type:"info",size:"small","native-type":"button"},on:{click:e.handleMoreClick}},[e._v("更多审核人")])],1),t("van-tree-select",{attrs:{"active-id":e.activeIds,"main-active-index":e.activeIndex,items:e.assigneeList},on:{"update:activeId":function(t){e.activeIds=t},"update:active-id":function(t){e.activeIds=t},"update:mainActiveIndex":function(t){e.activeIndex=t},"update:main-active-index":function(t){e.activeIndex=t}}}),t("van-button",{staticClass:"van-button-sure",on:{click:e.handleTreeSelect}},[e._v("确定")])],1)],1)},i=[],o=n("5530"),r=(n("4de4"),n("7db0"),n("c740"),n("4160"),n("14d9"),n("b64b"),n("d3b7"),n("ac1f"),n("00b4"),n("0643"),n("2382"),n("fffc"),n("4e3e"),n("159b"),n("2f62")),s=n("f8b7"),c=n("b705"),d=n("fd99"),u={name:"PerfectInfo",mixins:[d["a"]],computed:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["userInfo"])),Object(r["b"])("CarApplication",["CarOneHist","CarCopData"])),data:function(){return{pattern:/^1[3456789]\d{9}$/,dictReqReason:[],dictReqRange:[],dictModelType:[],dictGuarantee:[],nReasonShowPicker:!1,nRangeShowPicker:!1,sHopeCartyPicker:!1,sGuaranteePicker:!1,assigneeShow:!1,nReasonActiveIndex:0,nRangeActiveIndex:0,sHopeCartyActiveIndex:1,sGuaranteeActiveIndex:0,originAssigneeList:[],assigneeList:[],fieldNames:{text:"name",value:"code",children:"children"},form:{fromAddr:"",fromAreaId:"",toAddr:"",toAreaIdd:"",usageDate:"",usageTime:"",reason:"",reasonCode:"",demand:"",demandCode:"",timeLength:"2",longDistanceTag:"0",userName:"",userId:"",phone:"",hopeBrand:"",hopeBrandName:"",usagePersons:"1",remark:"",source:"2",procDefId:"",assignee:"",guaranteeName:"",guarantee:"",createType:"0"},activeIds:[],activeIndex:0,activeIcon:"/static/radio_checked.png",inactiveIcon:"/static/radio_default.png"}},created:function(){var e=this;Object.keys(this.CarOneHist).length||this.$notify({type:"warning",message:"请先填写用车申请基本信息!",onClose:function(){e.$router.back()}}),this.initPreviousFormData(),this.form.userName=this.userInfo.realName,this.form.phone=this.userInfo.phone,Object.keys(this.CarCopData).length&&(this.form.reasonCode=this.CarCopData.reasonCode,this.form.demandCode=this.CarCopData.demandCode,this.form.timeLength=this.CarCopData.timeLength,this.form.longDistanceTag=this.CarCopData.longDistanceTag+"",this.form.phone=this.CarCopData.phone,this.form.hopeBrand=this.CarCopData.hopeBrand,this.form.remark=this.CarCopData.remark,this.form.guarantee=this.CarCopData.guarantee),this.dictGetReqReason(),this.dictGetReqRange(),this.dictGetModelType(),this.dictGetGuarantee()},activated:function(){this.initPreviousFormData()},methods:{initPreviousFormData:function(){this.form.fromAddr=this.CarOneHist.sFromAddr+" "+this.CarOneHist.sFromAddrDetail,this.form.fromAreaId=this.CarOneHist.fromProvinceId+","+this.CarOneHist.fromCityId+","+this.CarOneHist.fromAreaId,this.form.toAddr=this.CarOneHist.sTargetAddr+" "+this.CarOneHist.sTargetAddrDetail,this.form.toAreaIdd=this.CarOneHist.targetProvinceId+","+this.CarOneHist.targetCityId+","+this.CarOneHist.targetAreaId,this.form.usageDate=this.CarOneHist.dDepartureTime,this.form.usageTime=this.CarOneHist.dDepartureTimeDetail},dictGetModelType:function(){var e=this;Object(c["a"])("101801").then((function(t){var n=t.data;if(e.dictModelType=n,Object.keys(e.CarCopData).length){e.sHopeCartyActiveIndex=e.dictModelType.findIndex((function(t){return t.code===e.form.hopeBrand}));var a=e.dictModelType.find((function(t){return t.code===e.form.hopeBrand}));e.form.hopeBrandName=a.name}else e.form.hopeBrandName=n[e.sHopeCartyActiveIndex].name,e.form.hopeBrand=n[e.sHopeCartyActiveIndex].code})).catch((function(e){}))},dictGetReqRange:function(){var e=this;Object(c["a"])("10018").then((function(t){var n=t.data;if(e.dictReqRange=n,Object.keys(e.CarCopData).length){e.nRangeActiveIndex=e.dictReqRange.findIndex((function(t){return t.code===e.form.demandCode}));var a=e.dictReqRange.find((function(t){return t.code===e.form.demandCode}));e.form.demand=a.name}else e.form.demand=n[e.nRangeActiveIndex].name,e.form.demandCode=n[e.nRangeActiveIndex].code})).catch((function(e){}))},dictGetReqReason:function(){var e=this;Object(c["a"])("1016").then((function(t){var n=t.data;if(e.dictReqReason=n,Object.keys(e.CarCopData).length){e.nReasonActiveIndex=e.dictReqReason.findIndex((function(t){return t.code===e.form.reasonCode}));var a=e.dictReqReason.find((function(t){return t.code===e.form.reasonCode}));e.form.reason=a.name}else e.form.reason=n[e.nReasonActiveIndex].name,e.form.reasonCode=n[e.nReasonActiveIndex].code})).catch((function(e){}))},dictGetGuarantee:function(){var e=this;Object(c["a"])("1679651627836055552").then((function(t){var n=t.data;if(e.dictGuarantee=n,Object.keys(e.CarCopData).length){e.sGuaranteeActiveIndex=e.dictGuarantee.findIndex((function(t){return t.code===e.form.guarantee}));var a=e.dictGuarantee.find((function(t){return t.code===e.form.guarantee}));e.form.guaranteeName=a.name}else e.form.guaranteeName=n[e.sGuaranteeActiveIndex].name,e.form.guarantee=n[e.sGuaranteeActiveIndex].code})).catch((function(e){}))},nReasonConfirm:function(e){this.form.reason=e.name,this.form.reasonCode=e.code,this.nReasonShowPicker=!1},nRangeConfirm:function(e){this.form.demand=e.name,this.form.demandCode=e.code,this.nRangeShowPicker=!1},sHopeCartyConfirm:function(e){this.form.hopeBrandName=e.name,this.form.hopeBrand=e.code,this.sHopeCartyPicker=!1},sGuaranteeConfirm:function(e){this.form.guaranteeName=e.name,this.form.guarantee=e.code,this.sGuaranteePicker=!1},handleConfirmClick:function(){this.form.reasonCode?this.form.demandCode?this.form.timeLength&&"0"!==this.form.timeLength?this.form.longDistanceTag?this.form.userName?this.form.phone?this.pattern.test(this.form.phone)?this.form.hopeBrand?this.form.guarantee?this.form.usagePersons?"4"!=this.form.reasonCode||this.form.remark?this.getActivitiAssigneeList():this.$notify({type:"warning",message:"请填写备注!"}):this.$notify({type:"warning",message:"请填写乘坐人数!"}):this.$notify({type:"warning",message:"请选择优先保障类型!"}):this.$notify({type:"warning",message:"请选择期望车型!"}):this.$notify({type:"warning",message:"联系电话格式有误,请输入正确的联系电话!"}):this.$notify({type:"warning",message:"请填写联系电话!"}):this.$notify({type:"warning",message:"请填写乘车人!"}):this.$notify({type:"warning",message:"请选择是否长途!"}):this.$notify({type:"warning",message:"请填写用车时长!"}):this.$notify({type:"warning",message:"请选择用车需求!"}):this.$notify({type:"warning",message:"请选择用车事由!"})},getActivitiAssigneeList:function(){var e=this;Object(s["a"])({type:"用车审批"}).then((function(t){var n=t.data;if(n.procDefId){if(n.procDefId)if(e.form.procDefId=n.procDefId,n.assignee)e.form.assignee=n.assignee,e.vehicleInfoAdd();else{e.originAssigneeList=e.getTreeData(n.assigneeList);var a=n.assigneeList.filter((function(e){return"0"===e.hide}));e.assigneeList=e.getTreeData(a),e.assigneeShow=!0}}else e.vehicleInfoAdd()}))},getTreeData:function(e){var t=[];return t.push({text:"",children:[]}),e.forEach((function(e){t[0].children.push({text:e.name,id:e.code})})),t},handleMoreClick:function(){this.assigneeList=this.originAssigneeList},handleTreeSelect:function(){this.activeIds.length?(this.assigneeShow=!1,this.form.candidateUser=this.activeIds,this.vehicleInfoAdd()):this.$notify({type:"warning",message:"请选择审批人!"})},vehicleInfoAdd:function(){var e=this,t=this.$toast.loading({duration:0,message:"提交中..",forbidClick:!0});Object(s["c"])(Object.assign({},this.form)).then((function(t){var n=t.data;e.$store.dispatch("CarApplication/clearOneDataAction"),e.$router.push({name:"SubSuccess",params:{id:n}})})).catch((function(t){e.$toast.fail("提交失败!")})).finally((function(){t.clear()}))}}},l=u,f=(n("65bb"),n("2877")),m=Object(f["a"])(l,a,i,!1,null,"02bd8eb7",null);t["default"]=m.exports},"65bb":function(e,t,n){"use strict";n("1e4f")},f8b7:function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return v}));var a=n("b775");function i(e){return Object(a["a"])({url:"/order/getOrderDetail",method:"GET",params:e})}function o(e){return Object(a["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:e})}function r(e){return Object(a["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:e})}function s(e){return Object(a["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:e})}function c(e){return Object(a["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:e})}function d(e){return Object(a["a"])({url:"/activiti/assigneeList",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:e})}function l(e){return Object(a["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:e})}function f(e){return Object(a["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:e})}function m(e){return Object(a["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:e})}function h(e){return Object(a["a"])({url:"/activiti/assigneeListByType",method:"get",params:e})}function p(e){return Object(a["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:e})}function g(e){return Object(a["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:e})}function v(e){return Object(a["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:e})}},fd99:function(e,t,n){"use strict";t["a"]={created:function(){this.$options.name||console.warn("缓存页面失败！没有设置组件名！"),this.$store.commit("keepThisPage",this.$options.name)},beforeDestroy:function(){}}}}]);