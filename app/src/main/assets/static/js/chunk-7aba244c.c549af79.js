(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7aba244c"],{"986e":function(t,e,i){"use strict";var n=i("2b0e"),a=new n["d"]({});e["a"]=a},a40c:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("car-rental-base-detail",{attrs:{orderDetail:t.orderDetail,hasButton:t.checkHasButton()}}),"1"!=t.orderDetail.status&&"2"!=t.orderDetail.status||"CarRentalExamineList"!=t.source?t._e():e("div",{staticClass:"default-button-container-two"},[e("van-button",{attrs:{block:"",type:"default",round:""},on:{click:function(e){return t.handleReject()}}},[t._v("驳回")]),e("van-button",{attrs:{block:"",type:"info",round:""},on:{click:function(e){return t.handleAdopt()}}},[t._v("通过")])],1),"4"!==t.orderDetail.vehicleProperties&&"3"==t.orderDetail.status&&"0"==t.orderDetail.maintainStatus&&"CarRentalList"==t.source?e("div",{staticClass:"default-button-container-one"},[e("van-button",{attrs:{block:"",type:"info",round:""},on:{click:function(e){return t.handleMaintenance()}}},[t._v("维护")])],1):t._e(),e("assignee-popup",{attrs:{assigneePopupShow:t.assigneePopupShow,assigneeList:t.assigneeList},on:{assigneeSelected:t.assigneeSelected}})],1)},a=[],s=(i("4160"),i("14d9"),i("b64b"),i("d3b7"),i("0643"),i("4e3e"),i("159b"),i("e782")),r=i("6321"),o=i("f8b7"),c=i("7b51"),u=i("986e"),d=i("fd99"),l={name:"CarRentalDetail",mixins:[d["a"]],components:{AssigneePopup:r["a"],CarRentalBaseDetail:c["a"]},data:function(){return{id:"",orderDetail:{},assigneePopupShow:!1,assigneeList:[],candidateUser:[],listItem:{},source:""}},created:function(){this.id=this.$route.params.id,this.source=this.$route.params.source,"CarRentalExamineList"==this.source&&(this.listItem=JSON.parse(this.$route.params.item)),u["a"].$off("rejectConfirm"),u["a"].$on("rejectConfirm",function(t){this.requestReject(t)}.bind(this)),this.getCarRentalDetail()},methods:{getCarRentalDetail:function(){var t=this,e=this.$toast.loading({duration:0,message:"正在加载...",forbidClick:!0}),i={id:this.id,hlogFlag:"1"};Object(s["f"])(i).then((function(e){var i=e.data;t.orderDetail=i,t.appendixList=i.files,t.activitiList=i.logs})).catch((function(t){})).finally((function(){e.clear()}))},checkHasButton:function(){return("1"==this.orderDetail.status||"2"==this.orderDetail.status)&&"CarRentalExamineList"==this.source||("4"!==this.orderDetail.vehicleProperties&&"3"==this.orderDetail.status&&"0"==this.orderDetail.maintainStatus&&"CarRentalList"==this.source||void 0)},handleReject:function(){this.$router.push({name:"CarRentalRejectEdit",params:{}})},requestReject:function(t){var e=this,i=this.$toast.loading({duration:0,message:"正在驳回..",forbidClick:!0}),n={comment:t,businessId:this.orderDetail.id,procInstId:this.listItem.procInstId,taskId:this.listItem.taskId};Object(s["b"])(n).then((function(t){var i=t.message;e.$notify({type:"success",message:i}),e.$router.push({name:"CarRentalExamineList",params:{refresh:!0}})})).catch((function(t){e.$toast.fail("驳回失败!")})).finally((function(){i.clear()}))},handleAdopt:function(){"1"==this.orderDetail.status||"2"==this.orderDetail.status?this.listItem.workflowId?this.listItem.procInstId?this.listItem.endTimeMe?this.$toast("你不是审批人！"):this.getActivityAssigneeList():this.$toast("你不是审批人！"):this.getActivityAssigneeList():this.$toast("已审核数据无法重新审核!")},getActivityAssigneeList:function(){var t=this,e=this.$toast.loading({duration:0,message:"正在加载...",forbidClick:!0}),i={businessId:this.orderDetail.id,procDefId:"",procInstId:this.listItem.procInstId,actId:this.listItem.actId};Object(o["b"])(i).then((function(e){var i=e.data;i.assignee?(t.candidateUser.push(i.assignee),t.showAgreeApprovalOrderDialog()):i.assigneeList&&i.assigneeList.length>0?(t.assigneeList=t.getTreeData(i.assigneeList),t.assigneePopupShow=!0):t.showAgreeApprovalOrderDialog()})).catch((function(t){})).finally((function(){e.clear()}))},getTreeData:function(t){var e=[];return e.push({text:"",children:[]}),t.forEach((function(t){e[0].children.push({text:t.name,id:t.code})})),e},assigneeSelected:function(t){t&&(this.candidateUser=t,this.showAgreeApprovalOrderDialog()),this.assigneePopupShow=!1},showAgreeApprovalOrderDialog:function(){var t=this;this.$dialog.confirm({title:"提示",message:"是否要审批通过?"}).then((function(){t.approvalOrderApi()})).catch((function(){}))},approvalOrderApi:function(){var t=this,e=this.$toast.loading({duration:0,message:"正在提交审批..",forbidClick:!0}),i={businessId:this.orderDetail.id,procInstId:this.listItem.procInstId,taskId:this.listItem.taskId,comment:"同意",candidateUser:this.candidateUser};Object(s["a"])(i).then((function(e){var i=e.message;t.$notify({type:"success",message:i}),t.$router.push({name:"CarRentalExamineList",params:{refresh:!0}})})).catch((function(e){t.$toast.fail("审批失败!")})).finally((function(){e.clear()}))},handleMaintenance:function(){this.$router.push({name:"CarMaintenance",params:{id:this.id}})}}},h=l,f=i("2877"),p=Object(f["a"])(h,n,a,!1,null,"d6bc4674",null);e["default"]=p.exports},f8b7:function(t,e,i){"use strict";i.d(e,"l",(function(){return a})),i.d(e,"m",(function(){return s})),i.d(e,"i",(function(){return r})),i.d(e,"j",(function(){return o})),i.d(e,"n",(function(){return c})),i.d(e,"b",(function(){return u})),i.d(e,"d",(function(){return d})),i.d(e,"e",(function(){return l})),i.d(e,"k",(function(){return h})),i.d(e,"c",(function(){return f})),i.d(e,"a",(function(){return p})),i.d(e,"f",(function(){return m})),i.d(e,"h",(function(){return g})),i.d(e,"g",(function(){return b}));var n=i("b775");function a(t){return Object(n["a"])({url:"/order/getOrderDetail",method:"GET",params:t})}function s(t){return Object(n["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:t})}function r(t){return Object(n["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:t})}function o(t){return Object(n["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:t})}function c(t){return Object(n["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:t})}function u(t){return Object(n["a"])({url:"/activiti/assigneeList",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:t})}function l(t){return Object(n["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:t})}function h(t){return Object(n["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:t})}function f(t){return Object(n["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/activiti/assigneeListByType",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:t})}function g(t){return Object(n["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:t})}function b(t){return Object(n["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:t})}},fd99:function(t,e,i){"use strict";e["a"]={created:function(){this.$options.name||console.warn("缓存页面失败！没有设置组件名！"),this.$store.commit("keepThisPage",this.$options.name)},beforeDestroy:function(){}}}}]);