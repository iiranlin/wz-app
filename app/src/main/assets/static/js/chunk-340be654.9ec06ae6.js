(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-340be654"],{"5b81":function(e,t,r){"use strict";var i=r("23e7"),n=r("c65b"),a=r("e330"),s=r("1d80"),u=r("1626"),c=r("7234"),o=r("44e7"),d=r("577e"),l=r("dc4a"),h=r("90d8"),f=r("0cb2"),p=r("b622"),m=r("c430"),g=p("replace"),b=TypeError,v=a("".indexOf),D=a("".replace),O=a("".slice),y=Math.max;i({target:"String",proto:!0},{replaceAll:function(e,t){var r,i,a,p,j,q,A,T,C,w,R=s(this),L=0,U="";if(!c(e)){if(r=o(e),r&&(i=d(s(h(e))),!~v(i,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(a=l(e,g),a)return n(a,e,R,t);if(m&&r)return D(d(R),e,t)}p=d(R),j=d(e),q=u(t),q||(t=d(t)),A=j.length,T=y(1,A),C=v(p,j);while(-1!==C)w=q?d(t(j,C,p)):f(j,p,C,[],void 0,t),U+=O(p,L,C)+w,L=C+A,C=C+T>p.length?-1:v(p,j,C+T);return L<p.length&&(U+=O(p,L)),U}})},a85d:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-container"},[t("general-order-detail",{attrs:{orderDetail:e.orderDetail,approveLogList:e.approveLogList,hasButton:!0},on:{handleDeleteCar:e.handleDeleteCar}}),t("div",{staticClass:"default-button-container-two"},[t("van-button",{attrs:{block:"",type:"default",round:""},on:{click:function(t){return e.handleAddCar()}}},[e._v("添加车辆")]),t("van-button",{attrs:{block:"",type:"info",round:""},on:{click:function(t){return e.handleDispatch()}}},[e._v("确认派单")])],1)],1)},n=[],a=(r("d81d"),r("14d9"),r("a434"),r("f4b3"),r("e9c4"),r("b64b"),r("d3b7"),r("a573"),r("8a60")),s=r("f8b7"),u=r("f527"),c={name:"ConfirmDistribute",components:{GeneralOrderDetail:a["a"]},data:function(){return{orderDetail:{},type:"",approveLogList:[]}},created:function(){this.orderDetail=JSON.parse(this.$route.params.obj),this.type=this.$route.params.type,"artificial"!==this.type&&this.getOrderApprovalLog()},methods:{getOrderApprovalLog:function(){var e=this,t=this.$toast.loading({duration:0,message:"加载中..",forbidClick:!0}),r={reqId:this.orderDetail.id};Object(s["i"])(r).then((function(t){var r=t.data;e.approveLogList=r})).catch((function(){})).finally((function(){t.clear()}))},handleAddCar:function(){this.$router.push({name:"DispatchVehicle",params:{obj:JSON.stringify(this.orderDetail),type:this.type}})},handleDeleteCar:function(e){this.orderDetail.reqAssignments.splice(e,1)},handleDispatch:function(){var e=this;this.$dialog.confirm({title:"提示",message:"是否确认派单?"}).then((function(){"artificial"==e.type?e.requestArtificialDispatch():"dispatch"==e.type?e.requestDispatch():"changeDispatch"==e.type&&e.requestChangeDispatch()})).catch((function(){}))},requestArtificialDispatch:function(){var e=this,t=this.$toast.loading({duration:0,message:"正在取消..",forbidClick:!0});this.orderDetail.reqAssignments=this.orderDetail.reqAssignments.map((function(e){return{id:e.id,restatus:e.restatus||"",driver:e.driver,driverId:e.driverCode,driverPhone:e.phone,beginMiles:e.startMiles,carNumber:e.carNumber,vinNumber:e.vinNumber}})),Object(u["e"])(this.orderDetail).then((function(t){var r=t.message;e.$notify({type:"success",message:r}),e.$store.dispatch("DispathOrder/triggerFefresh",!0),e.$router.push({name:"DispatchOrderList",params:{}})})).catch((function(t){e.$toast.fail("派单失败!")})).finally((function(){t.clear()}))},requestDispatch:function(){var e=this,t=this.$toast.loading({duration:0,message:"正在取消..",forbidClick:!0}),r={status:this.orderDetail.status,id:this.orderDetail.id,phone:this.orderDetail.phone,createType:this.orderDetail.createType,usageDate:this.orderDetail.usageDate,usageTime:this.orderDetail.usageTime,handleUserId:this.orderDetail.handleUserId,handleUserName:this.orderDetail.handleUserName,handleUnit:this.orderDetail.handleUnit,handleUnitCode:this.orderDetail.handleUnitCode,fromAddr:this.orderDetail.fromAddr,toAddr:this.orderDetail.toAddr,reqAssignments:[]};r.reqAssignments=this.orderDetail.reqAssignments.map((function(e){return{id:e.id,restatus:e.restatus||"",driver:e.driver,driverId:e.driverCode,driverPhone:e.phone,beginMiles:e.startMiles,carNumber:e.carNumber,vinNumber:e.vinNumber}})),Object(u["e"])(r).then((function(t){var r=t.message;e.$notify({type:"success",message:r}),e.$router.push({name:"DispathSuccess",params:{id:e.orderDetail.id}})})).catch((function(t){e.$toast.fail("派单失败!")})).finally((function(){t.clear()}))},requestChangeDispatch:function(){var e=this,t=this.$toast.loading({duration:0,message:"正在取消..",forbidClick:!0}),r={status:this.orderDetail.status,id:this.orderDetail.id,phone:this.orderDetail.phone,createType:this.orderDetail.createType,usageDate:this.orderDetail.usageDate,usageTime:this.orderDetail.usageTime,handleUserId:this.orderDetail.handleUserId,handleUserName:this.orderDetail.handleUserName,handleUnit:this.orderDetail.handleUnit,handleUnitCode:this.orderDetail.handleUnitCode,fromAddr:this.orderDetail.fromAddr,toAddr:this.orderDetail.toAddr,reqAssignments:[]};r.reqAssignments=this.orderDetail.reqAssignments.map((function(e){return{id:e.id,restatus:e.restatus||"",driver:e.driver,driverId:"1"==e.restatus?e.driverId:e.driverCode,driverPhone:"1"==e.restatus?e.driverPhone:e.phone,beginMiles:"1"==e.restatus?e.beginMiles:e.startMiles,carNumber:e.carNumber,vinNumber:e.vinNumber}})),Object(u["o"])(r).then((function(t){var r=t.message;e.$notify({type:"success",message:r}),e.$router.push({name:"DispathSuccess",params:{id:e.orderDetail.id}})})).catch((function(t){e.$toast.fail("派单失败!")})).finally((function(){t.clear()}))}}},o=c,d=r("2877"),l=Object(d["a"])(o,i,n,!1,null,"3ca298d7",null);t["default"]=l.exports},f527:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"n",(function(){return c})),r.d(t,"g",(function(){return o})),r.d(t,"j",(function(){return d})),r.d(t,"p",(function(){return l})),r.d(t,"f",(function(){return h})),r.d(t,"r",(function(){return f})),r.d(t,"l",(function(){return p})),r.d(t,"h",(function(){return m})),r.d(t,"e",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"m",(function(){return v})),r.d(t,"b",(function(){return D})),r.d(t,"q",(function(){return O})),r.d(t,"i",(function(){return y})),r.d(t,"k",(function(){return j}));var i=r("b775"),n="",a=n+"/dispatch/carPic";function s(e){return Object(i["a"])({url:"/dispatch/dispatchList",method:"GET",params:e})}function u(e){return Object(i["a"])({url:"/dispatch/dispatchedList",method:"GET",params:e})}function c(e){return Object(i["a"])({url:"/dispatch/historyList",method:"GET",params:e})}function o(e){return Object(i["a"])({url:"/dispatch/getAvailableCar",method:"GET",params:e})}function d(e){return Object(i["a"])({url:"/vehicleInfo/getAssignCount",method:"GET",params:e})}function l(e){return Object(i["a"])({url:"/dispatch/saveOrderDispatch",method:"POST",data:e})}function h(e){return Object(i["a"])({url:"/dispatch/reassignment",method:"POST",data:e})}function f(e,t){return Object(i["a"])({url:"/vehicleInfo/".concat(t?"getResAvailableCar":"getAvailableCar"),method:"get",params:e})}function p(e){return Object(i["a"])({url:"/gcjcDriverClass/getRGAvailableDriver",method:"get",params:e})}function m(e){return Object(i["a"])({url:"/gcjcDriverClass/getAvailableDriver",method:"get",params:e})}function g(e){return Object(i["a"])({url:"/gcywVehicleRequest/saveOrderDispatch",method:"POST",data:e})}function b(e){return Object(i["a"])({url:"/gcywVehicleRequest/reassignment",method:"POST",data:e})}function v(e){return Object(i["a"])({url:"/gcjcTurnUnit/listAll",method:"GET",params:e})}function D(e){return Object(i["a"])({url:"/gcywVehicleRequest/redispatch",method:"POST",data:e})}function O(e){return Object(i["a"])({url:"/gcywVehicleRequest/updateRessUnit",method:"post",data:e})}function y(e){return Object(i["a"])({url:"/system/unit/getAvailableUnit",method:"GET",params:e})}function j(e){return Object(i["a"])({url:"/dept/tree",method:"GET",params:e})}},f8b7:function(e,t,r){"use strict";r.d(t,"l",(function(){return n})),r.d(t,"m",(function(){return a})),r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return u})),r.d(t,"n",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return l})),r.d(t,"k",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return p})),r.d(t,"f",(function(){return m})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return b}));var i=r("b775");function n(e){return Object(i["a"])({url:"/order/getOrderDetail",method:"GET",params:e})}function a(e){return Object(i["a"])({url:"/gcywVehicleRequest/dispatchListInfoH5",method:"GET",params:e})}function s(e){return Object(i["a"])({url:"/gcywVehicleRequestLog/list",method:"GET",params:e})}function u(e){return Object(i["a"])({url:"/gcywVehicleRequest/cancelVehicleRequest",method:"POST",data:e})}function c(e){return Object(i["a"])({url:"/gcywVehicleRequest/activiti/reject",method:"POST",data:e})}function o(e){return Object(i["a"])({url:"/activiti/assigneeList",method:"post",data:e})}function d(e){return Object(i["a"])({url:"/gcywVehicleRequest/activiti/complete",method:"POST",data:e})}function l(e){return Object(i["a"])({url:"/gcywVehicleRequest/listPage",method:"GET",params:e})}function h(e){return Object(i["a"])({url:"/gcywVehicleRequest/confirmVehicleRequest",method:"POST",data:e})}function f(e){return Object(i["a"])({url:"/gcywVehicleRequest/addVehicleRequest",method:"post",data:e})}function p(e){return Object(i["a"])({url:"/activiti/assigneeListByType",method:"get",params:e})}function m(e){return Object(i["a"])({url:"/gcywVehicleRequest/dispatchList",method:"get",params:e})}function g(e){return Object(i["a"])({url:"/gcywVehicleRequestLog/list",method:"get",params:e})}function b(e){return Object(i["a"])({url:"/gcywVehicleRequest/listPageForH5",method:"get",params:e})}}}]);